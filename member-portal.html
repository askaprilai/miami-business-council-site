<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Portal | Miami Business Council</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/png" href="Images/MBC BLACK LOGO NONTRANSPARENT (1).png">
    
    <!-- SEO and Social Sharing -->
    <meta name="description" content="Miami Business Council Member Portal - Connect with business leaders through AI-powered matching, direct chat, and exclusive networking events">
    <meta name="keywords" content="Miami Business Council, networking, business leaders, AI matching, member portal">
    
    <!-- Open Graph / Social Media Preview -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Miami Business Council Member Portal">
    <meta property="og:description" content="Connect with Miami's business leaders through AI-powered smart matching, direct messaging, and exclusive networking opportunities">
    <meta property="og:image" content="https://miamibusinesscouncil.com/Images/portal-preview.png">
    <meta property="og:url" content="https://miamibusinesscouncil.com/member-portal.html">
    <meta property="og:site_name" content="Miami Business Council">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Miami Business Council Member Portal">
    <meta name="twitter:description" content="Connect with Miami's business leaders through AI-powered smart matching and direct messaging">
    <meta name="twitter:image" content="https://miamibusinesscouncil.com/Images/portal-preview.png">
    
    <!-- LinkedIn -->
    <meta property="article:author" content="Miami Business Council">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#d4af37">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MBC Portal">
    <meta name="application-name" content="Miami Business Council">
    <meta name="msapplication-TileColor" content="#d4af37">
    <meta name="msapplication-starturl" content="/member-portal.html">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="Images/MBC BLACK LOGO NONTRANSPARENT (1).png">
    <link rel="apple-touch-icon" sizes="152x152" href="Images/MBC BLACK LOGO NONTRANSPARENT (1).png">
    <link rel="apple-touch-icon" sizes="180x180" href="Images/MBC BLACK LOGO NONTRANSPARENT (1).png">
    <link rel="apple-touch-icon" sizes="167x167" href="Images/MBC BLACK LOGO NONTRANSPARENT (1).png">

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.5;
            color: #f1f3f4;
            background: #121212;
            min-height: 100vh;
            font-weight: 400;
            letter-spacing: -0.011em;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Header */
        .portal-header {
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .portal-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .portal-logo img {
            height: 40px;
            width: auto;
        }

        .portal-logo span {
            font-size: 1.2em;
            font-weight: 600;
            color: #d4af37;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #000;
        }

        /* Button Design System - Standardized Styles */
        
        /* Base Button Styles */
        .btn-base {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-height: 44px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            color: #000;
            font-weight: 600;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #f4af37 0%, #d4af37 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e8eaed;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border-color: rgba(255, 255, 255, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            font-weight: 600;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #45a049 0%, #4CAF50 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-linkedin {
            background: linear-gradient(135deg, #0077B5 0%, #005885 100%);
            color: white;
            font-weight: 600;
        }

        .btn-linkedin:hover {
            background: linear-gradient(135deg, #005885 0%, #0077B5 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 119, 181, 0.3);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            min-height: 36px;
        }

        .btn-large {
            padding: 1rem 2rem;
            font-size: 1rem;
            min-height: 52px;
        }

        .btn-icon-only {
            padding: 0.75rem;
            min-width: 44px;
        }

        /* Apply standardized button styles */
        .logout-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #e8eaed;
            padding: 0.75rem 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Main Layout */
        .portal-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 2rem 2rem 320px;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 1.5rem 1.5rem 8rem 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: calc(100vh - 140px);
            min-height: 600px;
            position: fixed;
            top: 120px;
            left: 2rem;
            width: 280px;
            overflow-y: auto;
            z-index: 1000;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: block;
            padding: 0.75rem 1rem;
            color: #e8eaed;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
        }


        /* Loading States & Skeleton Screens */
        .skeleton {
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.05) 0%, 
                rgba(255, 255, 255, 0.1) 50%, 
                rgba(255, 255, 255, 0.05) 100%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .skeleton-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 1rem;
        }

        .skeleton-text {
            height: 1rem;
            margin-bottom: 0.75rem;
            border-radius: 4px;
        }

        .skeleton-text-title {
            height: 1.25rem;
            width: 70%;
        }

        .skeleton-text-body {
            width: 100%;
        }

        .skeleton-text-body:last-child {
            width: 85%;
        }

        .skeleton-button {
            height: 2.5rem;
            width: 120px;
            border-radius: 8px;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(18, 18, 18, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
            z-index: 999;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(212, 175, 55, 0.3);
            border-top: 3px solid #d4af37;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-message {
            margin-left: 1rem;
            color: #d4af37;
            font-weight: 500;
        }

        /* Form Validation Styles */
        .form-field-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .form-field-error {
            border-color: #ff6b6b !important;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.3) !important;
        }

        .form-field-success {
            border-color: #51cf66 !important;
            box-shadow: 0 0 10px rgba(81, 207, 102, 0.3) !important;
        }

        .field-error-message {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(255, 107, 107, 0.15);
            color: #ff6b6b;
            padding: 0.5rem 0.75rem;
            border-radius: 0 0 8px 8px;
            font-size: 0.8rem;
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-top: none;
            display: none;
            z-index: 10;
        }

        .field-error-message.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .field-success-message {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #51cf66;
            font-size: 1.2rem;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-validation-summary {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: none;
        }

        .form-validation-summary.show {
            display: block;
        }

        .form-validation-summary h4 {
            color: #ff6b6b;
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .form-validation-summary ul {
            margin: 0;
            padding-left: 1.25rem;
        }

        .form-validation-summary li {
            color: #ff6b6b;
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        /* Enhanced Error States */
        .error-toast {
            position: fixed;
            top: 100px;
            right: 2rem;
            background: rgba(255, 107, 107, 0.95);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            z-index: 10000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .error-toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .success-toast {
            position: fixed;
            top: 100px;
            right: 2rem;
            background: rgba(81, 207, 102, 0.95);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            z-index: 10000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .success-toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* Admin Member List Styles */
        .member-list-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .member-list-table th,
        .member-list-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .member-list-table th {
            background: rgba(255, 255, 255, 0.05);
            color: #d4af37;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .member-list-table td {
            color: #f1f3f4;
            font-size: 0.9rem;
        }

        .member-list-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .member-status {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .member-status.active {
            background: rgba(81, 207, 102, 0.2);
            color: #51cf66;
        }

        .member-status.pending {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .member-actions-cell {
            white-space: nowrap;
        }

        .member-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #e8eaed;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-right: 0.5rem;
            transition: all 0.3s ease;
        }

        .member-action-btn:hover {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
        }

        .member-list-summary {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .summary-number {
            font-size: 1.5rem;
            font-weight: 600;
            color: #d4af37;
        }

        .summary-label {
            font-size: 0.8rem;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Main Content */
        .main-content {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-family: 'Poppins', 'Inter', sans-serif;
            font-size: 2rem;
            font-weight: 600;
            color: #d4af37;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        /* Sidebar Support Button */
        .sidebar-support {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            text-align: center;
            margin-top: auto;
        }

        .support-btn {
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            color: #000;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        .support-btn:hover {
            background: linear-gradient(135deg, #f4af37 0%, #d4af37 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .support-text {
            color: #999;
            font-size: 0.8rem;
            margin-top: 0.5rem;
        }

        /* Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #e8eaed;
        }

        .card-icon {
            font-size: 1.5em;
            color: #d4af37;
        }

        /* Member Directory */
        .member-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .member-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .member-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }

        .member-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .member-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #000;
            font-size: 1.2em;
        }

        .member-info h3 {
            font-size: 1.1em;
            color: #f1f3f4; /* Improved contrast */
            margin-bottom: 0.25rem;
        }

        .member-info p {
            color: #d4d6da; /* Improved contrast from #ccc */
            font-size: 0.9em;
        }

        .member-details {
            margin: 1rem 0;
        }

        .member-tag {
            display: inline-block;
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8em;
            margin: 0.25rem 0.25rem 0.25rem 0;
        }

        .linkedin-btn {
            background: linear-gradient(135deg, #0077B5 0%, #005885 100%);
            color: white;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            min-height: 44px;
            cursor: pointer;
        }

        .linkedin-btn:hover {
            background: linear-gradient(135deg, #005885 0%, #0077B5 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 119, 181, 0.3);
        }

        /* Events */
        .event-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .event-date {
            background: #d4af37;
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
        }

        .event-info h3 {
            color: #e8eaed;
            margin-bottom: 0.5rem;
        }

        .event-details {
            color: #ccc;
            margin-bottom: 1rem;
        }

        .register-btn {
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            color: #000;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .register-btn:hover {
            background: linear-gradient(135deg, #f4af37 0%, #d4af37 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        /* Search */
        .search-bar {
            margin-bottom: 2rem;
        }

        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 0.75rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #e8eaed;
            font-size: 1em;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* Profile Styles */
        .profile-field {
            margin-bottom: 1rem;
        }

        .profile-field label {
            display: block;
            margin-bottom: 0.5rem;
            color: #e8eaed;
        }

        .profile-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #e8eaed;
            font-size: 1em;
        }

        .profile-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }

        .opportunity-section {
            margin-bottom: 1.5rem;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .opportunity-tag {
            background: rgba(255, 255, 255, 0.1);
            color: #ccc;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9em;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .opportunity-tag.active {
            background: rgba(212, 175, 55, 0.3);
            color: #d4af37;
            border-color: #d4af37;
        }

        .opportunity-tag:hover {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .radio-option input[type="radio"] {
            accent-color: #d4af37;
        }

        .radio-option span {
            color: #e8eaed;
        }

        /* Notification Badge */
        .notification-badge {
            background: #d4af37;
            color: #000;
            font-size: 0.7em;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        /* Chat Styles */
        .chat-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            height: 600px;
            border-radius: 16px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-sidebar {
            background: rgba(255, 255, 255, 0.02);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
        }

        .chat-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
        }

        .chat-search {
            width: 100%;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #fff;
            font-size: 0.9rem;
        }

        .chat-search::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .conversation-list {
            padding: 0;
        }

        .conversation-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .conversation-item:hover,
        .conversation-item.active {
            background: rgba(212, 175, 55, 0.1);
        }

        .conversation-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 600;
            margin-right: 0.75rem;
            font-size: 0.9rem;
        }

        .conversation-info {
            flex: 1;
            min-width: 0;
        }

        .conversation-name {
            font-weight: 600;
            color: #e8eaed;
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }

        .conversation-preview {
            color: #ccc;
            font-size: 0.8rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .conversation-meta {
            text-align: right;
            font-size: 0.7rem;
            color: #999;
        }

        .conversation-unread {
            background: #d4af37;
            color: #000;
            font-size: 0.6rem;
            padding: 0.2rem 0.4rem;
            border-radius: 8px;
            font-weight: 600;
            margin-top: 0.2rem;
            display: inline-block;
        }

        .chat-main {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chat-window-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-window-info {
            display: flex;
            align-items: center;
        }

        .chat-window-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 600;
            margin-right: 0.75rem;
        }

        .chat-window-details h4 {
            color: #e8eaed;
            margin: 0;
            font-size: 1rem;
        }

        .chat-window-details p {
            color: #ccc;
            margin: 0;
            font-size: 0.8rem;
        }

        .chat-actions {
            display: flex;
            gap: 0.5rem;
        }

        .chat-action-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #e8eaed;
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .chat-action-btn:hover {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
        }

        .messages-container {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
        }

        .message.own {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 600;
            font-size: 0.8rem;
            margin: 0 0.5rem;
        }

        .message.own .message-avatar {
            background: #ccc;
        }

        .message-content {
            max-width: 70%;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.75rem;
            border-radius: 12px;
            position: relative;
        }

        .message.own .message-content {
            background: rgba(212, 175, 55, 0.2);
        }

        .message-text {
            color: #e8eaed;
            margin-bottom: 0.25rem;
            line-height: 1.4;
        }

        .message-time {
            color: #999;
            font-size: 0.7rem;
        }

        .chat-input-container {
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .chat-input {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 0.9rem;
            resize: none;
            font-family: inherit;
        }

        .chat-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .chat-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }

        .chat-send-container {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .chat-send-btn {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-send-btn:hover {
            background: #f4af37;
        }

        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chat-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #ccc;
            text-align: center;
        }

        .chat-placeholder h3 {
            color: #d4af37;
            margin-bottom: 1rem;
        }

        /* Chat Container Styles */
        .chat-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 1rem;
            height: 600px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .chat-sidebar {
            background: rgba(255, 255, 255, 0.05);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }

        .chat-sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(212, 175, 55, 0.1);
        }

        .chat-sidebar-header h3 {
            color: #d4af37;
            margin: 0;
            font-size: 1rem;
        }

        .conversations-list {
            flex: 1;
            overflow-y: auto;
        }

        .conversation-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
        }

        .conversation-item:hover {
            background: rgba(212, 175, 55, 0.1);
        }

        .conversation-item.unread {
            background: rgba(212, 175, 55, 0.05);
            border-left: 3px solid #d4af37;
        }

        .conversation-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .conversation-details {
            flex: 1;
            min-width: 0;
        }

        .conversation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.25rem;
        }

        .conversation-name {
            font-weight: 500;
            color: #e8eaed;
            font-size: 0.9rem;
        }

        .conversation-time {
            font-size: 0.7rem;
            color: #999;
        }

        .conversation-preview {
            font-size: 0.8rem;
            color: #d4d6da; /* Improved contrast from #ccc */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .unread-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #d4af37;
            color: #000;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .chat-main {
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.1);
        }

        .chat-area {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chat-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-member-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #d4af37;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .chat-member-name {
            font-weight: 500;
            color: #e8eaed;
        }

        .chat-member-company {
            font-size: 0.8rem;
            color: #ccc;
        }

        /* Photo Upload Styles */
        .photo-upload-section {
            text-align: center;
        }

        .photo-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #666;
        }

        .photo-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .photo-placeholder p {
            font-size: 0.8rem;
            margin: 0;
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .upload-controls {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .upload-btn, .remove-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .upload-btn {
            background: #d4af37;
            color: #000;
        }

        .upload-btn:hover {
            background: #f4af37;
        }

        .remove-btn {
            background: rgba(220, 53, 69, 0.2);
            color: #ff6b6b;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .remove-btn:hover {
            background: rgba(220, 53, 69, 0.3);
        }

        /* Privacy Settings Styles */
        .privacy-setting {
            margin-bottom: 1rem;
        }

        .toggle-container {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            cursor: pointer;
        }

        .privacy-toggle {
            display: none;
        }

        .toggle-label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            cursor: pointer;
            width: 100%;
        }

        .toggle-switch {
            width: 50px;
            height: 26px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 13px;
            position: relative;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
            flex-shrink: 0;
            margin-top: 0.1rem;
        }

        .toggle-switch::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: #fff;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .privacy-toggle:checked + .toggle-label .toggle-switch {
            background: #d4af37;
            border-color: #d4af37;
        }

        .privacy-toggle:checked + .toggle-label .toggle-switch::before {
            left: 26px;
            background: #000;
        }

        .toggle-text {
            color: #e8eaed;
            font-weight: 500;
            line-height: 1.4;
        }

        .setting-description {
            color: #ccc;
            font-size: 0.85rem;
            margin-top: 0.5rem;
            line-height: 1.4;
            margin-left: 3.25rem;
        }

        /* Email Button Styles */
        .email-btn {
            background: linear-gradient(135deg, #0077B5 0%, #005885 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            min-height: 44px;
        }

        .email-btn:hover {
            background: linear-gradient(135deg, #005885 0%, #0077B5 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 119, 181, 0.3);
        }

        .email-btn:active {
            transform: translateY(0);
        }

        .email-btn.disabled {
            background: rgba(255, 255, 255, 0.1);
            color: #666;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .email-btn.disabled:hover {
            transform: none;
            box-shadow: none;
        }

        /* Search Bar Styles */
        .search-bar {
            position: relative;
            margin-bottom: 2rem;
        }

        .search-input {
            width: 100%;
            padding: 1rem 3rem 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #f1f3f4;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            font-weight: 400;
            letter-spacing: -0.011em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .search-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.75); /* Improved contrast from 0.6 */
        }

        .search-clear-btn {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: #ccc;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-clear-btn:hover {
            background: rgba(220, 53, 69, 0.3);
            color: #ff6b6b;
        }

        .member-card.hidden {
            display: none;
        }

        .no-results {
            text-align: center;
            padding: 3rem 2rem;
            color: #ccc;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-top: 1rem;
        }

        .no-results h3 {
            color: #d4af37;
            margin-bottom: 1rem;
        }

        /* Member Actions */
        .member-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .member-actions .linkedin-btn,
        .member-actions .email-btn,
        .member-actions .message-btn {
            flex: 1;
            min-width: 80px;
            text-align: center;
            justify-content: center;
            font-size: 0.8rem;
            padding: 0.5rem 0.75rem;
        }

        .message-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            min-height: 44px;
        }

        .message-btn:hover {
            background: linear-gradient(135deg, #45a049 0%, #4CAF50 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        /* Member Card Styles */
        .member-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .member-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
            border-color: rgba(212, 175, 55, 0.3);
        }

        .member-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .member-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #000;
            font-size: 1.8rem;
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
            border: 3px solid rgba(212, 175, 55, 0.6);
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .member-card:hover .member-avatar {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.6);
        }

        .member-card {
            cursor: pointer;
        }

        /* Member Profile Modal */
        .member-profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .member-profile-content {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .profile-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: #e8eaed;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .profile-close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .profile-hero {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #000;
            font-size: 2.5rem;
            box-shadow: 0 8px 30px rgba(212, 175, 55, 0.4);
            border: 4px solid rgba(212, 175, 55, 0.6);
            margin: 0 auto 1rem auto;
        }

        .profile-name {
            color: #e8eaed;
            font-size: 1.8rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
        }

        .profile-title {
            color: #d4af37;
            font-size: 1.1rem;
            font-weight: 500;
            margin: 0 0 0.5rem 0;
        }

        .profile-company {
            color: #ccc;
            font-size: 1rem;
            margin: 0;
        }

        .profile-section {
            margin-bottom: 2rem;
        }

        .profile-section h3 {
            color: #d4af37;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .profile-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .profile-tag {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9em;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .profile-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .profile-action-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .profile-action-btn.primary {
            background: #d4af37;
            color: #000;
        }

        .profile-action-btn.primary:hover {
            background: #f4af37;
        }

        .profile-action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e8eaed;
        }

        .profile-action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .profile-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .profile-info-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-info-label {
            color: #d4af37;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .profile-info-value {
            color: #e8eaed;
            font-size: 1rem;
        }

        /* Connection Request Styles */
        .connection-request {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .connection-request:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(212, 175, 55, 0.3);
        }

        .connection-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .connection-actions .profile-action-btn {
            padding: 0.6rem 1.2rem;
            font-size: 0.9rem;
        }

        /* Admin Panel Styles */
        .member-management-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .member-management-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .member-management-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(212, 175, 55, 0.3);
        }

        .member-management-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .member-management-actions .profile-action-btn {
            padding: 0.6rem 1rem;
            font-size: 0.85rem;
        }

        /* Profile Progress Indicator */
        .profile-progress-card {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .progress-header h3 {
            color: #d4af37;
            margin: 0;
            font-size: 1.4rem;
        }

        .progress-percentage {
            font-size: 1.2rem;
            font-weight: 700;
            color: #d4af37;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #d4af37 0%, #f4af37 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-tips {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .tip-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .tip-item.completed {
            background: rgba(81, 207, 102, 0.1);
            border-left: 3px solid #51cf66;
        }

        .tip-icon {
            font-size: 1.1rem;
        }

        .tip-text {
            flex: 1;
            color: #e8eaed;
            font-size: 0.9rem;
        }

        .tip-status {
            font-size: 1rem;
            color: #51cf66;
        }

        .progress-action {
            text-align: center;
        }

        .complete-profile-btn {
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            color: #000;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        .complete-profile-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        @media (max-width: 768px) {
            .progress-tips {
                grid-template-columns: 1fr;
            }
            
            .profile-progress-card {
                padding: 1.5rem;
            }
        }

        .member-info {
            flex: 1;
        }

        .member-info h3 {
            margin: 0 0 0.25rem 0;
            color: #e8eaed;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .member-info p {
            margin: 0;
            color: #ccc;
            font-size: 0.9rem;
        }

        .member-details {
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .member-tag {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .member-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        /* Referral System Styles */
        .referral-points-badge {
            background: #d4af37;
            color: #000;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .referral-link-container {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .referral-link-input {
            flex: 1;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .copy-link-btn {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .copy-link-btn:hover {
            background: #f4af37;
        }

        .share-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .share-btn.email {
            background: #0077b5;
            color: white;
        }

        .share-btn.linkedin {
            background: #0a66c2;
            color: white;
        }

        .share-btn.sms {
            background: #25d366;
            color: white;
        }

        .share-btn.generic {
            background: rgba(255, 255, 255, 0.1);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .share-btn:hover {
            transform: translateY(-1px);
            filter: brightness(1.1);
        }

        .referral-stats {
            display: grid;
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .stat-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 600;
            color: #d4af37;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: #ccc;
            font-size: 0.8rem;
        }

        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .reward-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .reward-card.unlocked {
            border-color: #d4af37;
            box-shadow: 0 0 0 1px rgba(212, 175, 55, 0.3);
        }

        .reward-card.locked {
            opacity: 0.6;
        }

        .reward-card:hover.unlocked {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }

        .reward-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .reward-title {
            font-weight: 600;
            color: #e8eaed;
            margin-bottom: 0.5rem;
        }

        .reward-description {
            color: #ccc;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
        }

        .reward-cost {
            color: #d4af37;
            font-weight: 500;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        .claim-reward-btn {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .claim-reward-btn:hover:not(.disabled) {
            background: #f4af37;
        }

        .claim-reward-btn.disabled {
            background: rgba(255, 255, 255, 0.1);
            color: #666;
            cursor: not-allowed;
        }

        /* PWA Install Prompt */
        .pwa-install-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
            color: #000;
            padding: 1rem;
            display: none;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

        .pwa-close-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.75rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #000;
            cursor: pointer;
            padding: 0.25rem;
            line-height: 1;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .pwa-close-btn:hover {
            opacity: 1;
        }

        .pwa-install-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            gap: 1rem;
        }

        .pwa-install-text {
            flex: 1;
        }

        .pwa-install-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .pwa-install-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .pwa-install-actions {
            display: flex;
            gap: 0.5rem;
        }

        .pwa-install-btn, .pwa-dismiss-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pwa-install-btn {
            background: #000;
            color: #d4af37;
        }

        .pwa-dismiss-btn {
            background: rgba(0, 0, 0, 0.1);
            color: #000;
        }

        .pwa-install-btn:hover {
            background: #333;
        }

        .pwa-dismiss-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .portal-container {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 1rem;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: auto;
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(20px);
                z-index: 99;
                transform: translateY(-100%);
                transition: transform 0.3s ease;
                border-radius: 0 0 20px 20px;
            }

            .sidebar.mobile-open {
                transform: translateY(0);
            }

            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 1rem;
                gap: 0.5rem;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }

            .nav-menu::-webkit-scrollbar {
                display: none;
            }

            .nav-item {
                margin-bottom: 0;
                flex-shrink: 0;
            }

            .nav-link {
                padding: 0.5rem 1rem;
                white-space: nowrap;
                font-size: 0.9rem;
            }

            .main-content {
                padding: 1rem;
                margin-top: 60px;
            }

            .header-content {
                padding: 0 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .member-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .chat-container {
                grid-template-columns: 1fr;
                height: calc(100vh - 200px);
                position: relative;
            }

            .chat-sidebar {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 10;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .chat-sidebar.mobile-open {
                transform: translateX(0);
            }

            .chat-main {
                position: relative;
            }

            .rewards-grid {
                grid-template-columns: 1fr;
            }

            .referral-stats {
                grid-template-columns: repeat(3, 1fr);
            }

            .pwa-install-content {
                flex-direction: column;
                text-align: center;
            }

            .pwa-install-actions {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .dashboard-card {
                margin-bottom: 1rem;
            }

            .profile-field label {
                font-size: 0.9rem;
            }

            .profile-input, .form-control {
                padding: 0.75rem;
                font-size: 0.9rem;
            }

            .share-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .member-actions {
                flex-direction: column;
            }

            .member-actions .linkedin-btn,
            .member-actions .email-btn {
                flex: none;
                width: 100%;
            }
        }

        /* Touch-friendly improvements */
        @media (pointer: coarse) {
            .nav-link, .btn, .register-btn, .email-btn, .linkedin-btn {
                min-height: 44px;
                touch-action: manipulation;
            }

            .member-card {
                touch-action: manipulation;
            }

            .conversation-item {
                min-height: 60px;
                touch-action: manipulation;
            }
        }

        /* Dark mode safe area insets for mobile */
        @supports (padding: max(0px)) {
            .portal-header {
                padding-left: max(1rem, env(safe-area-inset-left));
                padding-right: max(1rem, env(safe-area-inset-right));
                padding-top: max(1rem, env(safe-area-inset-top));
            }

            .pwa-install-banner {
                padding-left: max(1rem, env(safe-area-inset-left));
                padding-right: max(1rem, env(safe-area-inset-right));
                padding-bottom: max(1rem, env(safe-area-inset-bottom));
            }
        }

        /* Match Cards */
        .match-grid {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }

        .match-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .match-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .match-header h4 {
            margin: 0;
            color: #e8eaed;
            font-size: 1.1em;
        }

        .match-header p {
            margin: 0;
            color: #ccc;
            font-size: 0.9em;
        }

        .match-score {
            background: #d4af37;
            color: #000;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            margin-left: auto;
        }

        .match-details {
            margin-bottom: 1rem;
            color: #ccc;
            line-height: 1.6;
        }

        .match-details p {
            margin-bottom: 0.5rem;
        }

        .match-actions {
            display: flex;
            gap: 1rem;
        }

        .connect-btn {
            background: #d4af37;
            color: #000;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .connect-btn:hover {
            background: #f4af37;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .portal-container {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 1rem;
            }

            .sidebar {
                position: static;
                order: 2;
            }

            .main-content {
                order: 1;
            }

            .header-content {
                padding: 0 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .member-grid {
                grid-template-columns: 1fr;
            }

            .tag-container {
                flex-direction: column;
                align-items: flex-start;
            }

            .match-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="portal-header">
        <div class="header-content">
            <div class="portal-logo">
                <img src="Images/MBC BLACK LOGO NONTRANSPARENT (1).png" alt="Miami Business Council">
                <span>Member Portal</span>
            </div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">JS</div>
                <span id="userName">John Smith</span>
                <a href="#" class="logout-btn" onclick="logout()">Logout</a>
            </div>
        </div>
    </header>

    <!-- PWA Install Banner -->
    <div class="pwa-install-banner" id="pwaInstallBanner">
        <button class="pwa-close-btn" id="pwaCloseBtn">&times;</button>
        <div class="pwa-install-content">
            <div class="pwa-install-text">
                <div class="pwa-install-title"> Install MBC Portal</div>
                <div class="pwa-install-description">Add to your phone's home screen for quick access to members, chat, and networking</div>
            </div>
            <div class="pwa-install-actions">
                <button class="pwa-install-btn" id="pwaInstallBtn">Install</button>
                <button class="pwa-dismiss-btn" id="pwaDismissBtn">Maybe Later</button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="portal-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard"> Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="smart-matches"> Smart Matches</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="directory"> Member Directory</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="connections"> Connections <span id="connectionNotificationBadge" class="notification-badge" style="display: none;">2</span></a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="messages"> Messages <span id="messageNotificationBadge" class="notification-badge" style="display: none;">3</span></a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="events"> Events</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="profile"> My Profile</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="admin"> Admin Panel</a>
                </li>
            </ul>
            
            <!-- Support Button at Bottom of Sidebar -->
            <div class="sidebar-support">
                <a href="mailto:info@miamibusinesscouncil.com" class="support-btn">
                     Support
                </a>
                <div class="support-text">Need help? Contact us</div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h1 class="section-title">Dashboard</h1>
                    <p id="personalizedWelcome">Welcome to your Miami Business Council member portal</p>
                </div>

                <!-- Personalized Welcome Card -->
                <div class="dashboard-card" id="personalizedWelcomeCard" style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%); border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 2rem;">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div class="member-avatar" id="dashboardUserAvatar" style="width: 60px; height: 60px; font-size: 1.5rem;">JS</div>
                        <div>
                            <h3 style="color: #d4af37; margin: 0;" id="dashboardUserName">Welcome back!</h3>
                            <p style="color: #ccc; margin: 0; font-size: 0.9rem;" id="dashboardUserRole">Member since 2025</p>
                        </div>
                        <div style="margin-left: auto; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                            <div style="color: #d4af37; font-weight: 600;" id="memberProfileStrength">75%</div>
                            <div style="color: #ccc; font-size: 0.8rem;">Profile Strength</div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; text-align: center;">
                        <div>
                            <div style="font-size: 1.5rem; color: #d4af37; font-weight: 600;" id="memberConnectionCount">12</div>
                            <div style="color: #ccc; font-size: 0.8rem;">Connections</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; color: #d4af37; font-weight: 600;" id="memberMessageCount">8</div>
                            <div style="color: #ccc; font-size: 0.8rem;">Messages</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; color: #d4af37; font-weight: 600;" id="memberEventCount">3</div>
                            <div style="color: #ccc; font-size: 0.8rem;">Events Attended</div>
                        </div>
                    </div>
                </div>

                <!-- Today's Insights -->
                <div class="dashboard-card" id="dailyInsights" style="margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin-bottom: 1rem;"> Today's Insights</h3>
                    <div id="insightsList" style="display: grid; gap: 0.75rem;">
                        <div class="insight-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #d4af37;">
                            <span style="font-size: 1.2rem;"></span>
                            <span style="color: #e8eaed;">You have <strong style="color: #d4af37;">3 new potential matches</strong> based on your updated profile</span>
                        </div>
                        <div class="insight-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #51cf66;">
                            <span style="font-size: 1.2rem;"></span>
                            <span style="color: #e8eaed;" id="messageInsight">2 members viewed your profile this week</span>
                        </div>
                        <div class="insight-item" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid #fab005;">
                            <span style="font-size: 1.2rem;"></span>
                            <span style="color: #e8eaed;">Next networking event is in <strong style="color: #fab005;">6 days</strong> - Register now!</span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Upcoming Events</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Next Breakfast:</strong> January 28th, 9:00 AM</p>
                        <p>Miami Design District</p>
                        <button class="register-btn" style="margin-top: 1rem; padding: 0.5rem 1rem; font-size: 0.9em;">Register Now</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Network Stats</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Total Members:</strong> <span id="totalMemberCount">0</span></p>
                        <p><strong>New Connections:</strong> 3 this month</p>
                        <p><strong>Events Attended:</strong> 2</p>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Quick Actions</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><a href="#" onclick="showSection('profile')" style="color: #d4af37; cursor: pointer;">Update Profile</a></p>
                        <p><a href="#" onclick="showSection('directory')" style="color: #d4af37; cursor: pointer;">Browse Directory</a></p>
                        <p><a href="#" onclick="showSection('events')" style="color: #d4af37; cursor: pointer;">View Events</a></p>
                    </div>
                </div>
            </section>

            <!-- Smart Matches Section -->
            <section id="smart-matches" class="content-section">
                <div class="section-header">
                    <h1 class="section-title"> Smart Matches</h1>
                    <p>AI-powered connections based on your ideal client profile and business goals</p>
                </div>

                <!-- Matching Stats -->
                <div class="dashboard-grid" style="margin-bottom: 2rem;">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Match Statistics</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Total Matches Found:</strong> <span id="totalMatches">8</span></p>
                        <p><strong>High-Priority Matches:</strong> <span id="highPriorityMatches">3</span></p>
                        <p><strong>New This Week:</strong> <span id="newMatches">2</span></p>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Match Quality</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Average Match Score:</strong> 85%</p>
                        <p><strong>Mutual Interest Matches:</strong> 4</p>
                        <p><strong>Your Profile Completion:</strong> 75%</p>
                        <button class="register-btn" onclick="showSection('profile')" style="margin-top: 1rem; padding: 0.5rem 1rem; font-size: 0.9em;">Complete Profile</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Quick Actions</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><a href="#" onclick="generateSmartMatches()" style="color: #d4af37; cursor: pointer;"> Refresh Matches</a></p>
                        <p><a href="#" onclick="scheduleMatchNotifications()" style="color: #d4af37; cursor: pointer;"> Weekly Match Alerts</a></p>
                    </div>
                </div>

                <!-- Match Filters -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin-bottom: 1rem;"> Filter Your Matches</h3>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
                        <div class="profile-field">
                            <label>Match Type:</label>
                            <select class="profile-input" id="matchTypeFilter" onchange="filterMatches()">
                                <option value="all">All Matches</option>
                                <option value="ideal-client">My Ideal Clients</option>
                                <option value="service-provider">Service Providers for Me</option>
                                <option value="mutual">Mutual Benefit</option>
                                <option value="partnership">Partnership Opportunities</option>
                            </select>
                        </div>
                        <div class="profile-field">
                            <label>Industry:</label>
                            <select class="profile-input" id="industryFilter" onchange="filterMatches()">
                                <option value="all">All Industries</option>
                                <option value="Technology">Technology</option>
                                <option value="Real Estate">Real Estate</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Finance">Finance</option>
                                <option value="Legal">Legal</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Retail">Retail</option>
                                <option value="Hospitality">Hospitality</option>
                                <option value="Non-Profit">Non-Profit</option>
                                <option value="Fashion">Fashion</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Architecture">Architecture</option>
                                <option value="Design">Design</option>
                                <option value="Creative">Creative</option>
                                <option value="Consulting">Consulting</option>
                            </select>
                        </div>
                        <div class="profile-field">
                            <label>Match Score:</label>
                            <select class="profile-input" id="scoreFilter" onchange="filterMatches()">
                                <option value="all">Any Score</option>
                                <option value="high">90%+ (High Match)</option>
                                <option value="good">75-89% (Good Match)</option>
                                <option value="fair">60-74% (Fair Match)</option>
                            </select>
                        </div>
                        <div class="profile-field">
                            <label>Availability:</label>
                            <select class="profile-input" id="availabilityFilter" onchange="filterMatches()">
                                <option value="all">All Members</option>
                                <option value="active">Recently Active</option>
                                <option value="looking">Actively Looking</option>
                                <option value="open">Open to Connections</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Smart Matches Results -->
                <div class="match-grid" id="smartMatchResults">
                    <!-- Matches will be populated by JavaScript -->
                </div>
            </section>

            <!-- Member Directory Section -->
            <section id="directory" class="content-section">
                <div class="section-header">
                    <h1 class="section-title">Member Directory</h1>
                    <p>Connect with fellow Miami business leaders</p>
                </div>

                <div class="search-bar">
                    <input type="text" class="search-input" id="memberSearchInput" placeholder="Search members by name, company, or industry..." oninput="filterMembers()">
                    <button class="search-clear-btn" id="clearSearchBtn" onclick="clearMemberSearch()" style="display: none;"></button>
                </div>

                <div class="member-grid">
                    <div class="member-card" onclick="openMemberProfile('april', 'April Sabral', 'Founder & CEO', 'AskApril AI', 'AS', ['Technology', 'AI/ML', 'Business'], 'april@apriljsabral.com', 'https://linkedin.com/in/apriljsabral')">
                        <div class="member-header">
                            <div class="member-avatar">AS</div>
                            <div class="member-info">
                                <h3>April Sabral</h3>
                                <p>Founder & CEO</p>
                                <p>AskApril AI</p>
                            </div>
                        </div>
                        <div class="member-details">
                            <span class="member-tag">Technology</span>
                            <span class="member-tag">AI/ML</span>
                            <span class="member-tag">Business</span>
                        </div>
                        <div class="member-actions" onclick="event.stopPropagation()">
                            <button class="message-btn" onclick="startChatFromDirectory('april', 'April Sabral', 'AskApril AI')" title="Send direct message">
                                 Message
                            </button>
                            <button class="linkedin-btn" onclick="openLinkedInFromCard(this)" title="View LinkedIn profile">
                                 LinkedIn
                            </button>
                            <button class="email-btn" onclick="sendMBCEmail('april@apriljsabral.com', 'April Sabral', 'April J. Sabral Consulting')" title="Send email">
                                 Email
                            </button>
                        </div>
                    </div>


                    <div class="member-card" onclick="openMemberProfile('joy', 'Joy Sabral', 'Retail Consultant', 'Owner Retail', 'JS', ['Retail', 'Consulting', 'Operations'], 'sabral@me.com', null)">
                        <div class="member-header">
                            <div class="member-avatar">JS</div>
                            <div class="member-info">
                                <h3>Joy Sabral</h3>
                                <p>Retail Consultant</p>
                                <p>Owner Retail</p>
                            </div>
                        </div>
                        <div class="member-details">
                            <span class="member-tag">Retail</span>
                            <span class="member-tag">Consulting</span>
                            <span class="member-tag">Operations</span>
                        </div>
                        <div class="member-actions" onclick="event.stopPropagation()">
                            <button class="message-btn" onclick="startChatFromDirectory('joy', 'Joy Sabral', 'Owner Retail')" title="Send direct message">
                                 Message
                            </button>
                            <button class="email-btn" onclick="sendMBCEmail('sabral@me.com', 'Joy Sabral', 'Owner Retail')" title="Send email">
                                 Email
                            </button>
                            <button class="linkedin-btn" onclick="alert('LinkedIn profile coming soon!')" title="LinkedIn profile">
                                 LinkedIn
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Messages Section -->
            <section id="messages" class="content-section">
                <div class="section-header">
                    <h1 class="section-title"> Messages</h1>
                    <p>Connect and chat with fellow members</p>
                </div>

                <div class="chat-container">
                    <!-- Chat Sidebar -->
                    <div class="chat-sidebar">
                        <div class="chat-sidebar-header">
                            <h3>Conversations</h3>
                        </div>
                        <div class="conversations-list" id="conversationsList">
                            <!-- Conversations will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Chat Area -->
                    <div class="chat-main">
                        <!-- Chat Placeholder -->
                        <div class="chat-placeholder" id="chatPlaceholder">
                            <h3> Start a Conversation</h3>
                            <p>Select a member from the left to start chatting</p>
                            <p>Build meaningful business relationships through direct communication</p>
                        </div>

                        <!-- Active Chat -->
                        <div class="chat-area" id="chatArea" style="display: none;">
                            <!-- Chat Header -->
                            <div class="chat-header" id="chatHeader">
                                <!-- Will be populated by JavaScript -->
                            </div>

                            <!-- Messages Container -->
                            <div class="messages-container" id="messagesContainer">
                                <!-- Messages will be populated by JavaScript -->
                            </div>

                            <!-- Chat Input -->
                            <div class="chat-input-container">
                                <textarea class="chat-input" id="chatInput" placeholder="Type your message..."></textarea>
                                <div class="chat-send-container">
                                    <button class="chat-send-btn" id="sendMessageBtn">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Connections Section -->
            <section id="connections" class="content-section">
                <div class="section-header">
                    <h1 class="section-title"> Connections</h1>
                    <p>Manage your connection requests and network</p>
                </div>

                <!-- Connection Stats -->
                <div class="dashboard-grid" style="margin-bottom: 2rem;">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Pending Requests</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Incoming:</strong> <span id="incomingRequests">2</span> requests</p>
                        <p><strong>Outgoing:</strong> <span id="outgoingRequests">1</span> sent</p>
                        <button class="register-btn" onclick="showPendingRequests()" style="margin-top: 1rem; padding: 0.5rem 1rem; font-size: 0.9em;">View Pending</button>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Active Connections</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Total Connections:</strong> 3</p>
                        <p><strong>This Month:</strong> 2 new</p>
                        <p><strong>Response Rate:</strong> 85%</p>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Quick Actions</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><a href="#" onclick="showSection('directory')" style="color: #d4af37; cursor: pointer;"> Find New Connections</a></p>
                        <p><a href="#" onclick="showSection('smart-matches')" style="color: #d4af37; cursor: pointer;"> Smart Matching</a></p>
                        <p><a href="#" onclick="showSection('messages')" style="color: #d4af37; cursor: pointer;"> Message Connections</a></p>
                    </div>
                </div>

                <!-- Connection Requests -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin-bottom: 1.5rem;"> Pending Connection Requests</h3>
                    
                    <div id="connectionRequests">
                        <!-- Incoming Requests -->
                        <div class="connection-request">
                            <div class="member-header" style="margin-bottom: 1rem;">
                                <div class="member-avatar">JS</div>
                                <div class="member-info">
                                    <h4>Joy Sabral</h4>
                                    <p>Retail Consultant  Owner Retail</p>
                                    <p style="color: #ccc; font-size: 0.9rem;">Wants to connect with you</p>
                                </div>
                                <div style="text-align: right; color: #d4af37; font-size: 0.9rem;">
                                    2 hours ago
                                </div>
                            </div>
                            <div class="connection-message" style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 3px solid #d4af37;">
                                <p style="color: #e8eaed; font-style: italic;">"Hi! I'd love to connect and explore potential collaboration opportunities in the retail space. Looking forward to networking!"</p>
                            </div>
                            <div class="connection-actions" style="display: flex; gap: 1rem;">
                                <button class="profile-action-btn primary" onclick="acceptConnection('joy', 'Joy Sabral')"> Accept</button>
                                <button class="profile-action-btn secondary" onclick="declineConnection('joy', 'Joy Sabral')"> Decline</button>
                                <button class="profile-action-btn secondary" onclick="openMemberProfile('joy', 'Joy Sabral', 'Retail Consultant', 'Owner Retail', 'JS', ['Retail', 'Consulting', 'Operations'], 'sabral@me.com', null)"> View Profile</button>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Active Connections -->
                <div class="dashboard-card">
                    <h3 style="color: #d4af37; margin-bottom: 1.5rem;"> Active Connections</h3>
                    
                    <div class="member-grid">
                        <div class="member-card" onclick="openMemberProfile('april', 'April Sabral', 'Founder & CEO', 'AskApril AI', 'AS', ['Technology', 'AI/ML', 'Business'], 'april@apriljsabral.com', 'https://linkedin.com/in/apriljsabral')">
                            <div class="member-header">
                                <div class="member-avatar">AS</div>
                                <div class="member-info">
                                    <h3>April Sabral</h3>
                                    <p>Founder & CEO</p>
                                    <p>AskApril AI</p>
                                </div>
                            </div>
                            <div class="member-details">
                                <span class="member-tag">Connected Jan 15</span>
                                <span class="member-tag">3 messages</span>
                            </div>
                            <div class="member-actions" onclick="event.stopPropagation()">
                                <button class="email-btn" onclick="sendMBCEmail('april@apriljsabral.com', 'April Sabral', 'AskApril AI')">
                                     Email
                                </button>
                                <button class="linkedin-btn" onclick="startChat('april', 'April Sabral', 'AskApril AI')">
                                     Chat
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Events Section -->
            <section id="events" class="content-section">
                <div class="section-header">
                    <h1 class="section-title">Events</h1>
                    <p>Upcoming networking events and workshops</p>
                </div>

                <div class="event-card">
                    <div class="event-header">
                        <div class="event-info">
                            <h3>Monthly Breakfast Networking</h3>
                            <div class="event-details">
                                <p><strong>Date:</strong> January 28th, 2025</p>
                                <p><strong>Time:</strong> 9:00 AM - 10:30 AM</p>
                                <p><strong>Location:</strong> Miami Design District</p>
                                <p><strong>Description:</strong> Connect with fellow business leaders over breakfast and coffee. Network, share insights, and build meaningful relationships.</p>
                            </div>
                        </div>
                        <div class="event-date">
                            JAN<br>28
                        </div>
                    </div>
                    <button class="register-btn">Register Now</button>
                </div>

            </section>

            <!-- Profile Section -->
            <section id="profile" class="content-section">
                <div class="section-header">
                    <h1 class="section-title">My Business Profile</h1>
                    <p>Optimize your profile for better business matching and opportunities</p>
                </div>

                <!-- Profile Completion Progress -->
                <div class="profile-progress-card">
                    <div class="progress-header">
                        <h3> Profile Strength</h3>
                        <span class="progress-percentage" id="profileCompletionPercentage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="profileProgressFill"></div>
                    </div>
                    <div class="progress-tips">
                        <div class="tip-item" id="tipBasicInfo">
                            <span class="tip-icon"></span>
                            <span class="tip-text">Complete basic information</span>
                            <span class="tip-status" id="statusBasicInfo"></span>
                        </div>
                        <div class="tip-item" id="tipPhoto">
                            <span class="tip-icon"></span>
                            <span class="tip-text">Add your profile photo</span>
                            <span class="tip-status" id="statusPhoto"></span>
                        </div>
                        <div class="tip-item" id="tipBusinessInfo">
                            <span class="tip-icon"></span>
                            <span class="tip-text">Set business preferences</span>
                            <span class="tip-status" id="statusBusinessInfo"></span>
                        </div>
                        <div class="tip-item" id="tipLinkedIn">
                            <span class="tip-icon"></span>
                            <span class="tip-text">Add LinkedIn profile</span>
                            <span class="tip-status" id="statusLinkedIn"></span>
                        </div>
                    </div>
                    <div class="progress-action">
                        <button class="complete-profile-btn" onclick="focusIncompleteSection()">
                            <span id="progressActionText">Complete Your Profile</span> 
                        </button>
                    </div>
                </div>

                <!-- Profile Photo Section -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title" style="color: #d4af37;"> Profile Photo & Company Logo</h3>
                    </div>
                    <p style="color: #ccc; margin-bottom: 1.5rem;">Add your personal photo or company logo to help other members recognize and connect with you.</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Personal Photo</h4>
                            <div class="photo-upload-section">
                                <div class="photo-preview" id="personalPhotoPreview">
                                    <div class="photo-placeholder">
                                        <span class="photo-icon"></span>
                                        <p>No photo uploaded</p>
                                    </div>
                                </div>
                                <div class="upload-controls">
                                    <input type="file" id="personalPhotoUpload" accept="image/*" style="display: none;">
                                    <button type="button" class="upload-btn" onclick="document.getElementById('personalPhotoUpload').click()">
                                         Upload Photo
                                    </button>
                                    <button type="button" class="remove-btn" id="removePersonalPhoto" style="display: none;" onclick="removePhoto('personal')">
                                         Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Company Logo</h4>
                            <div class="photo-upload-section">
                                <div class="photo-preview" id="companyLogoPreview">
                                    <div class="photo-placeholder">
                                        <span class="photo-icon"></span>
                                        <p>No logo uploaded</p>
                                    </div>
                                </div>
                                <div class="upload-controls">
                                    <input type="file" id="companyLogoUpload" accept="image/*" style="display: none;">
                                    <button type="button" class="upload-btn" onclick="document.getElementById('companyLogoUpload').click()">
                                         Upload Logo
                                    </button>
                                    <button type="button" class="remove-btn" id="removeCompanyLogo" style="display: none;" onclick="removePhoto('company')">
                                         Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 4px solid #d4af37;">
                        <p style="color: #d4af37; font-weight: 500; margin-bottom: 0.5rem;"> Photo Guidelines</p>
                        <ul style="color: #ccc; font-size: 0.9rem; margin-left: 1rem;">
                            <li>Personal photos work best when they're professional headshots</li>
                            <li>Company logos should be clear and high-resolution</li>
                            <li>Supported formats: JPG, PNG, GIF (max 5MB)</li>
                            <li>Square images (1:1 ratio) display best</li>
                        </ul>
                    </div>
                </div>

                <!-- Basic Profile Information -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title" style="color: #d4af37;"> Basic Information</h3>
                    </div>
                    <p style="color: #ccc; margin-bottom: 1.5rem;">Update your professional information to help other members connect with you.</p>

                    <div style="display: grid; gap: 1.5rem;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div class="form-group">
                                <label for="memberName" style="display: block; color: #e8eaed; margin-bottom: 0.5rem; font-weight: 500;">Full Name *</label>
                                <input type="text" id="memberName" class="profile-input" placeholder="John Doe" required style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #e8eaed; font-size: 1rem;">
                            </div>
                            <div class="form-group">
                                <label for="memberCompany" style="display: block; color: #e8eaed; margin-bottom: 0.5rem; font-weight: 500;">Company Name *</label>
                                <input type="text" id="memberCompany" class="profile-input" placeholder="Your Company Inc." required style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #e8eaed; font-size: 1rem;">
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div class="form-group">
                                <label for="memberTitle" style="display: block; color: #e8eaed; margin-bottom: 0.5rem; font-weight: 500;">Job Title *</label>
                                <input type="text" id="memberTitle" class="profile-input" placeholder="CEO, Founder, etc." required style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #e8eaed; font-size: 1rem;">
                            </div>
                            <div class="form-group">
                                <label for="memberIndustry" style="display: block; color: #e8eaed; margin-bottom: 0.5rem; font-weight: 500;">Industry *</label>
                                <select id="memberIndustry" class="profile-input" required style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #e8eaed; font-size: 1rem;">
                                    <option value="">Select Industry</option>
                                    <option value="Technology">Technology</option>
                                    <option value="Finance">Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Real Estate">Real Estate</option>
                                    <option value="Retail">Retail</option>
                                    <option value="Hospitality">Hospitality</option>
                                    <option value="Professional Services">Professional Services</option>
                                    <option value="Manufacturing">Manufacturing</option>
                                    <option value="Education">Education</option>
                                    <option value="Non-Profit">Non-Profit</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Consulting">Consulting</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="memberLinkedIn" style="display: block; color: #e8eaed; margin-bottom: 0.5rem; font-weight: 500;">LinkedIn Profile URL (Optional)</label>
                            <input type="url" id="memberLinkedIn" class="profile-input" placeholder="https://linkedin.com/in/yourprofile" style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #e8eaed; font-size: 1rem;">
                        </div>

                        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                            <button type="button" onclick="saveProfile()" style="padding: 0.75rem 2rem; background: #d4af37; color: #000; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
                                 Save Profile
                            </button>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 4px solid #d4af37;">
                        <p style="color: #d4af37; font-weight: 500; margin-bottom: 0.5rem;"> Profile Tips</p>
                        <ul style="color: #ccc; font-size: 0.9rem; margin-left: 1rem;">
                            <li>Complete all fields marked with * for better matching</li>
                            <li>Use your professional name as it appears on LinkedIn</li>
                            <li>Your profile helps other members find and connect with you</li>
                            <li>All changes are saved to your account instantly</li>
                        </ul>
                    </div>
                </div>

                <!-- Privacy & Communication Preferences -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title" style="color: #d4af37;"> Privacy & Communication Preferences</h3>
                    </div>
                    <p style="color: #ccc; margin-bottom: 1.5rem;">Control how other members can contact you and what information is shared.</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Email Preferences</h4>
                            <div class="privacy-setting">
                                <div class="toggle-container">
                                    <input type="checkbox" id="allowMemberEmails" class="privacy-toggle" checked>
                                    <label for="allowMemberEmails" class="toggle-label">
                                        <span class="toggle-switch"></span>
                                        <span class="toggle-text">Allow members to email me directly</span>
                                    </label>
                                </div>
                                <p class="setting-description">When enabled, other members can email you with a pre-filled template that identifies them as MBC members.</p>
                            </div>
                            
                            <div class="privacy-setting" style="margin-top: 1rem;">
                                <div class="toggle-container">
                                    <input type="checkbox" id="includePhoneInEmails" class="privacy-toggle">
                                    <label for="includePhoneInEmails" class="toggle-label">
                                        <span class="toggle-switch"></span>
                                        <span class="toggle-text">Include my phone number in email template</span>
                                    </label>
                                </div>
                                <p class="setting-description">Your phone number will be included in the email template for easier follow-up.</p>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Profile Visibility</h4>
                            <div class="privacy-setting">
                                <div class="toggle-container">
                                    <input type="checkbox" id="showEmailInDirectory" class="privacy-toggle">
                                    <label for="showEmailInDirectory" class="toggle-label">
                                        <span class="toggle-switch"></span>
                                        <span class="toggle-text">Show email address in member directory</span>
                                    </label>
                                </div>
                                <p class="setting-description">Other members will see your email address directly in the directory.</p>
                            </div>
                            
                            <div class="privacy-setting" style="margin-top: 1rem;">
                                <div class="toggle-container">
                                    <input type="checkbox" id="allowLinkedInConnection" class="privacy-toggle" checked>
                                    <label for="allowLinkedInConnection" class="toggle-label">
                                        <span class="toggle-switch"></span>
                                        <span class="toggle-text">Show LinkedIn profile link</span>
                                    </label>
                                </div>
                                <p class="setting-description">Members can connect with you on LinkedIn through your profile.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(40, 167, 69, 0.1); border-radius: 8px; border-left: 4px solid #51cf66;">
                        <p style="color: #51cf66; font-weight: 500; margin-bottom: 0.5rem;"> Email Security</p>
                        <ul style="color: #ccc; font-size: 0.9rem; margin-left: 1rem;">
                            <li>All emails include MBC member verification for authenticity</li>
                            <li>Your email address is never shared without your permission</li>
                            <li>Email templates include professional MBC branding</li>
                            <li>You can change these preferences anytime</li>
                        </ul>
                    </div>
                </div>

                <!-- Member Referral & Rewards System -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title" style="color: #d4af37;"> Invite & Earn Rewards</h3>
                        <span class="referral-points-badge" id="memberPoints">250 pts</span>
                    </div>
                    <p style="color: #ccc; margin-bottom: 1.5rem;">Grow the Miami Business Council community and earn exclusive rewards, speaking opportunities, and benefits!</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Your Referral Link</h4>
                            <div class="referral-link-container">
                                <input type="text" class="referral-link-input" id="referralLinkInput" value="https://miamibusinesscouncil.com/join?ref=AS2025" readonly>
                                <button class="copy-link-btn" onclick="copyReferralLink()"> Copy</button>
                            </div>
                            <div class="share-buttons" style="margin-top: 1rem;">
                                <button class="share-btn email" onclick="shareViaEmail()"> Email</button>
                                <button class="share-btn linkedin" onclick="shareOnLinkedIn()"> LinkedIn</button>
                                <button class="share-btn sms" onclick="shareViaSMS()"> SMS</button>
                                <button class="share-btn generic" onclick="shareGeneric()"> Share</button>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Your Referral Stats</h4>
                            <div class="referral-stats">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalInvites">12</span>
                                    <span class="stat-label">Total Invites Sent</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="successfulReferrals">3</span>
                                    <span class="stat-label">Successful Referrals</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number" id="conversionRate">25%</span>
                                    <span class="stat-label">Conversion Rate</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="rewards-section">
                        <h4 style="color: #e8eaed; margin-bottom: 1rem;"> Available Rewards</h4>
                        <div class="rewards-grid">
                            <div class="reward-card unlocked">
                                <div class="reward-icon"></div>
                                <div class="reward-details">
                                    <div class="reward-title">Speaking Opportunity</div>
                                    <div class="reward-description">Present at next MBC event</div>
                                    <div class="reward-cost">500 points</div>
                                </div>
                                <button class="claim-reward-btn" onclick="claimReward('speaking')">Claim</button>
                            </div>
                            
                            <div class="reward-card unlocked">
                                <div class="reward-icon"></div>
                                <div class="reward-details">
                                    <div class="reward-title">Affiliate Commission</div>
                                    <div class="reward-description">20% commission on referrals</div>
                                    <div class="reward-cost">300 points</div>
                                </div>
                                <button class="claim-reward-btn" onclick="claimReward('affiliate')">Claim</button>
                            </div>
                            
                            <div class="reward-card locked">
                                <div class="reward-icon"></div>
                                <div class="reward-details">
                                    <div class="reward-title">VIP Event Access</div>
                                    <div class="reward-description">Exclusive networking events</div>
                                    <div class="reward-cost">750 points</div>
                                </div>
                                <button class="claim-reward-btn disabled">Need 750 pts</button>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1rem; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 4px solid #d4af37;">
                        <p style="color: #d4af37; font-weight: 500; margin-bottom: 0.5rem;"> How It Works</p>
                        <ul style="color: #ccc; font-size: 0.9rem; margin-left: 1rem;">
                            <li><strong>Invite:</strong> Share your unique referral link with quality business contacts</li>
                            <li><strong>Earn:</strong> Get 100 points for each successful member referral</li>
                            <li><strong>Redeem:</strong> Use points for speaking slots, affiliate commissions, or exclusive access</li>
                            <li><strong>Grow:</strong> Help build Miami's premier business community while earning rewards</li>
                        </ul>
                    </div>
                </div>

                <!-- Smart Matching Section -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title" style="color: #d4af37;"> Smart Matching Profile</h3>
                        <button class="register-btn" onclick="generateSmartMatches()" style="padding: 0.5rem 1rem;">Find My Matches</button>
                    </div>
                    <p style="color: #ccc; margin-bottom: 2rem;">Help us connect you with your ideal clients, partners, and opportunities by completing your matching profile.</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> My Ideal Client Profile</h4>
                            <div class="profile-field">
                                <label>Industry Focus:</label>
                                <select class="profile-input" id="targetIndustry">
                                    <option value="">Select target industry</option>
                                    <option value="Technology">Technology & Software</option>
                                    <option value="Real Estate">Real Estate & Construction</option>
                                    <option value="Healthcare">Healthcare & Wellness</option>
                                    <option value="Finance">Finance & Investment</option>
                                    <option value="Marketing">Marketing & Advertising</option>
                                    <option value="Legal">Legal & Professional Services</option>
                                    <option value="Retail">Retail & E-commerce</option>
                                    <option value="Hospitality">Hospitality & Tourism</option>
                                    <option value="Non-Profit">Non-Profit & Social Impact</option>
                                    <option value="Design">Design & Creative</option>
                                    <option value="Creative">Creative & Arts</option>
                                    <option value="Fashion">Fashion & Apparel</option>
                                    <option value="Manufacturing">Manufacturing & Industrial</option>
                                    <option value="Public Relations">Public Relations & Communications</option>
                                    <option value="Media">Media & Entertainment</option>
                                    <option value="Wellness">Wellness & Fitness</option>
                                    <option value="Architecture">Architecture & Engineering</option>
                                    <option value="Consulting">Consulting & Advisory</option>
                                    <option value="Education">Education & Training</option>
                                    <option value="Any">Open to All Industries</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label>Company Size Preference:</label>
                                <select class="profile-input" id="targetSize">
                                    <option value="">Any size</option>
                                    <option value="startup">Startup (1-10 employees)</option>
                                    <option value="small">Small Business (11-50 employees)</option>
                                    <option value="medium">Medium Business (51-200 employees)</option>
                                    <option value="large">Large Enterprise (200+ employees)</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label>Budget Range (Annual):</label>
                                <select class="profile-input" id="targetBudget">
                                    <option value="">Not specified</option>
                                    <option value="under-10k">Under $10,000</option>
                                    <option value="10k-50k">$10,000 - $50,000</option>
                                    <option value="50k-100k">$50,000 - $100,000</option>
                                    <option value="100k-500k">$100,000 - $500,000</option>
                                    <option value="500k-plus">$500,000+</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label>Geographic Focus:</label>
                                <select class="profile-input" id="targetLocation">
                                    <option value="miami">Miami-Dade County</option>
                                    <option value="south-florida">South Florida Region</option>
                                    <option value="florida">Florida Statewide</option>
                                    <option value="southeast">Southeast US</option>
                                    <option value="national">National/Remote</option>
                                    <option value="international">International</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #e8eaed; margin-bottom: 1rem;"> What I Offer</h4>
                            <div class="profile-field">
                                <label>Primary Service/Product:</label>
                                <textarea class="profile-input" id="primaryOffering" placeholder="Describe your main service or product offering..." rows="3"></textarea>
                            </div>
                            <div class="profile-field">
                                <label>Unique Value Proposition:</label>
                                <textarea class="profile-input" id="valueProposition" placeholder="What makes you different from competitors?" rows="2"></textarea>
                            </div>
                            <div class="profile-field">
                                <label>Collaboration Style:</label>
                                <select class="profile-input" id="workStyle">
                                    <option value="in-person">Prefer In-Person Meetings</option>
                                    <option value="virtual">Comfortable with Virtual</option>
                                    <option value="hybrid">Flexible - Both Virtual & In-Person</option>
                                    <option value="project-based">Project-Based Engagement</option>
                                    <option value="ongoing">Long-term Partnership Focus</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label>Business Goals for 2025:</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 0.5rem;">
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="grow-revenue">
                                        <span>Grow Revenue</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="expand-team">
                                        <span>Expand Team</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="new-markets">
                                        <span>Enter New Markets</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="strategic-partnerships">
                                        <span>Strategic Partnerships</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="raise-funding">
                                        <span>Raise Funding</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="checkbox" name="business-goals" value="improve-operations">
                                        <span>Improve Operations</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid" style="grid-template-columns: 1fr 1fr; max-width: 1000px;">
                    <!-- Business Information -->
                    <div class="dashboard-card">
                        <h3 style="color: #d4af37; margin-bottom: 1rem;">Business Information</h3>
                        <div class="profile-field">
                            <label><strong>Name:</strong></label>
                            <input type="text" id="memberName" class="profile-input" placeholder="Enter your full name">
                        </div>
                        <div class="profile-field">
                            <label><strong>Company:</strong></label>
                            <input type="text" id="memberCompany" class="profile-input" placeholder="Enter your company name">
                        </div>
                        <div class="profile-field">
                            <label><strong>Title:</strong></label>
                            <input type="text" id="memberTitle" class="profile-input" placeholder="Enter your job title">
                        </div>
                        <div class="profile-field">
                            <label><strong>Industry:</strong></label>
                            <select id="memberIndustry" class="profile-input">
                                <option value="">Select your industry</option>
                                <option value="Technology">Technology</option>
                                <option value="Real Estate">Real Estate</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Finance">Finance</option>
                                <option value="Legal">Legal</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Retail">Retail</option>
                                <option value="Hospitality">Hospitality</option>
                                <option value="Non-Profit">Non-Profit</option>
                                <option value="Design">Design</option>
                                <option value="Fashion">Fashion</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Public Relations">Public Relations</option>
                                <option value="Media">Media</option>
                                <option value="Wellness">Wellness</option>
                                <option value="Architecture">Architecture</option>
                                <option value="Creative">Creative</option>
                                <option value="Consulting">Consulting</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="profile-field">
                            <label><strong>LinkedIn:</strong></label>
                            <input type="url" id="memberLinkedIn" class="profile-input" placeholder="linkedin.com/in/yourprofile">
                        </div>
                    </div>

                    <!-- Business Opportunities -->
                    <div class="dashboard-card">
                        <h3 style="color: #d4af37; margin-bottom: 1rem;">Business Matching</h3>
                        
                        <div class="opportunity-section">
                            <h4 style="color: #e8eaed; margin-bottom: 0.5rem;"> What I'm Looking For:</h4>
                            <div class="tag-container">
                                <span class="opportunity-tag" onclick="toggleTag(this)">Clients</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Partnerships</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Investors</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Mentors</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Vendors</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Co-founders</span>
                            </div>
                        </div>

                        <div class="opportunity-section">
                            <h4 style="color: #e8eaed; margin-bottom: 0.5rem;"> What I Can Offer:</h4>
                            <div class="tag-container">
                                <span class="opportunity-tag" onclick="toggleTag(this)">Business Strategy</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Consulting</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Funding</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Mentoring</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Services</span>
                                <span class="opportunity-tag" onclick="toggleTag(this)">Expertise</span>
                            </div>
                        </div>

                        <div class="opportunity-section">
                            <h4 style="color: #e8eaed; margin-bottom: 0.5rem;"> Company Size:</h4>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="company-size" value="solo">
                                    <span>Solo/Freelancer (1)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="company-size" value="small">
                                    <span>Small Team (2-10)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="company-size" value="medium">
                                    <span>Medium Business (11-50)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="company-size" value="large">
                                    <span>Large Company (50+)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Matching Results -->
                <div class="dashboard-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <h3 class="card-title"> Potential Business Matches</h3>
                        <button class="register-btn" onclick="findMatches()" style="padding: 0.5rem 1rem;">Find New Matches</button>
                    </div>
                    
                    <div class="match-grid" id="matchResults">
                        <div class="match-card">
                            <div class="match-header">
                                <div class="member-avatar">AS</div>
                                <div>
                                    <h4>April Sabral</h4>
                                    <p>AskApril AI  Technology</p>
                                </div>
                                <div class="match-score">92%</div>
                            </div>
                            <div class="match-details">
                                <p><strong>Looking for:</strong> Business partnerships, Marketing expertise</p>
                                <p><strong>Can offer:</strong> AI/Tech consulting, Platform development</p>
                                <p><strong>Match reason:</strong> Needs business strategy consulting</p>
                            </div>
                            <div class="match-actions">
                                <button class="connect-btn" onclick="connectWithMember('April Sabral')">Connect</button>
                                <button class="linkedin-btn" onclick="window.open('https://linkedin.com/in/apriljsabral', '_blank')">LinkedIn</button>
                            </div>
                        </div>

                        <div class="match-card">
                            <div class="match-header">
                                <div class="member-avatar">TM</div>
                                <div>
                                    <h4>Tommy Martinez</h4>
                                    <p>The Madyun Group  Real Estate</p>
                                </div>
                                <div class="match-score">78%</div>
                            </div>
                            <div class="match-details">
                                <p><strong>Looking for:</strong> Business development, Strategic partnerships</p>
                                <p><strong>Can offer:</strong> Real estate expertise, Network connections</p>
                                <p><strong>Match reason:</strong> Mutual partnership interests</p>
                            </div>
                            <div class="match-actions">
                                <button class="connect-btn" onclick="connectWithMember('Tommy Martinez')">Connect</button>
                                <button class="linkedin-btn" onclick="alert('LinkedIn profile coming soon')">LinkedIn</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="profile-actions" style="text-align: center; margin-top: 2rem;">
                    <button class="register-btn" onclick="saveProfile()" style="margin-right: 1rem;">Save Profile</button>
                    <button class="register-btn" onclick="shareProfile()" style="background: rgba(255,255,255,0.1); color: #e8eaed;">Share Profile</button>
                </div>
            </section>

            <!-- Admin Panel Section -->
            <section id="admin" class="content-section">
                <div class="section-header">
                    <h1 class="section-title"> Admin Panel</h1>
                    <p>Manage members, send invitations, and oversee portal activity</p>
                </div>

                <!-- Admin Stats -->
                <div class="dashboard-grid" style="margin-bottom: 2rem;">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Member Overview</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Total Members:</strong> <span id="adminTotalMemberCount">3</span></p>
                        <p><strong>Active This Month:</strong> 3</p>
                        <p><strong>Pending Invites:</strong> 0</p>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Portal Activity</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p><strong>Login Rate:</strong> 95%</p>
                        <p><strong>Profile Completion:</strong> 85%</p>
                        <p><strong>Connection Rate:</strong> 78%</p>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Activity</h3>
                            <span class="card-icon"></span>
                        </div>
                        <p> 2 new connections today</p>
                        <p> 1 profile updated</p>
                        <p> 3 messages sent</p>
                    </div>
                </div>

                <!-- Member List View -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3 style="color: #d4af37; margin: 0;"> All Members</h3>
                        <button class="btn-secondary btn-small" onclick="refreshMemberList()"> Refresh</button>
                    </div>
                    
                    <div id="memberListContainer" style="margin-top: 1rem;">
                        <div class="loading-message" style="text-align: center; padding: 2rem; color: #ccc;">
                            Loading member list...
                        </div>
                    </div>
                </div>

                <!-- Add New Member -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin-bottom: 1rem;"> Invite New Member</h3>
                    <p style="color: #ccc; margin-bottom: 1.5rem; font-size: 0.9rem;"> Send an invitation with login credentials. The member will complete their own profile after joining.</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="profile-field">
                            <label>First Name <span style="color: #ff6b6b;">*</span>:</label>
                            <input type="text" class="profile-input" id="newMemberFirstName" placeholder="Enter first name" required>
                        </div>
                        <div class="profile-field">
                            <label>Last Name <span style="color: #ff6b6b;">*</span>:</label>
                            <input type="text" class="profile-input" id="newMemberLastName" placeholder="Enter last name" required>
                        </div>
                    </div>

                    <div class="profile-field" style="margin-bottom: 1.5rem;">
                        <label>Email Address <span style="color: #ff6b6b;">*</span>:</label>
                        <input type="email" class="profile-input" id="newMemberEmail" placeholder="member@company.com" required>
                        <div style="font-size: 0.8rem; color: #999; margin-top: 0.5rem;">This will be their login username</div>
                    </div>

                    <div class="profile-field" style="margin-bottom: 1.5rem;">
                        <label>Personal Welcome Message (Optional):</label>
                        <textarea class="profile-input" id="newMemberMessage" placeholder="Add a personal welcome message (will be included in the invitation email)" rows="3" style="resize: vertical;"></textarea>
                    </div>

                    <div style="display: flex; gap: 1rem;">
                        <button class="register-btn" onclick="addNewMember()">
                             Add Member & Send Invitation
                        </button>
                        <button class="register-btn" onclick="previewInvitation()" style="background: rgba(255,255,255,0.1); color: #e8eaed;">
                             Preview Email
                        </button>
                    </div>
                </div>

                <!-- Member Management -->
                <div class="dashboard-card" style="margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin-bottom: 1.5rem;"> Member Management</h3>
                    
                    <div class="member-management-grid">
                        <div class="member-management-item">
                            <div class="member-header">
                                <div class="member-avatar">AS</div>
                                <div class="member-info">
                                    <h4>April Sabral</h4>
                                    <p>april@retailu.ca  AskApril AI</p>
                                    <p style="color: #51cf66; font-size: 0.9rem;"> Profile Complete  Last login: Today</p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #d4af37; font-size: 0.9rem;">Member Since</div>
                                    <div style="color: #ccc; font-size: 0.8rem;">Jan 15, 2025</div>
                                </div>
                            </div>
                            <div class="member-management-actions">
                                <button class="profile-action-btn secondary" onclick="sendProfileReminder('april@retailu.ca', 'April Sabral')">
                                     Profile Reminder
                                </button>
                                <button class="profile-action-btn secondary" onclick="resetMemberPassword('april@retailu.ca')">
                                     Reset Access
                                </button>
                                <button class="profile-action-btn secondary" onclick="viewMemberActivity('april')">
                                     Activity
                                </button>
                            </div>
                        </div>


                        <div class="member-management-item">
                            <div class="member-header">
                                <div class="member-avatar">JS</div>
                                <div class="member-info">
                                    <h4>Joy Sabral</h4>
                                    <p>sabral@me.com  Owner Retail</p>
                                    <p style="color: #f39c12; font-size: 0.9rem;"> Profile Incomplete  Last login: 2 days ago</p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #d4af37; font-size: 0.9rem;">Member Since</div>
                                    <div style="color: #ccc; font-size: 0.8rem;">Jan 12, 2025</div>
                                </div>
                            </div>
                            <div class="member-management-actions">
                                <button class="profile-action-btn primary" onclick="sendProfileReminder('sabral@me.com', 'Joy Sabral')">
                                     Complete Profile
                                </button>
                                <button class="profile-action-btn secondary" onclick="resetMemberPassword('sabral@me.com')">
                                     Reset Access
                                </button>
                                <button class="profile-action-btn secondary" onclick="viewMemberActivity('joy')">
                                     Activity
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bulk Actions -->
                <div class="dashboard-card">
                    <h3 style="color: #d4af37; margin-bottom: 1.5rem;"> Bulk Actions</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                        <button class="profile-action-btn secondary" onclick="sendBulkWelcomeEmails()">
                             Welcome Email Blast
                        </button>
                        <button class="profile-action-btn secondary" onclick="sendEventReminders()">
                             Event Reminders
                        </button>
                        <button class="profile-action-btn secondary" onclick="exportMemberData()">
                             Export Member Data
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Member Profile Modal -->
    <div class="member-profile-modal" id="memberProfileModal">
        <div class="member-profile-content">
            <button class="profile-close-btn" onclick="closeMemberProfile()"></button>
            
            <div class="profile-hero">
                <div class="profile-avatar-large" id="profileAvatarLarge">AS</div>
                <h2 class="profile-name" id="profileName">April Sabral</h2>
                <p class="profile-title" id="profileTitle">Founder & CEO</p>
                <p class="profile-company" id="profileCompany">AskApril AI</p>
            </div>

            <div class="profile-section">
                <h3> Professional Background</h3>
                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <div class="profile-info-label">Industry Focus</div>
                        <div class="profile-info-value" id="profileIndustry">Technology, AI/ML</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="profile-info-label">Member Since</div>
                        <div class="profile-info-value">January 2025</div>
                    </div>
                </div>
            </div>

            <div class="profile-section">
                <h3> Expertise & Services</h3>
                <div class="profile-tags" id="profileTags">
                    <span class="profile-tag">Technology</span>
                    <span class="profile-tag">AI/ML</span>
                    <span class="profile-tag">Business</span>
                </div>
            </div>

            <div class="profile-section">
                <h3> Business Interests</h3>
                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <div class="profile-info-label">Looking For</div>
                        <div class="profile-info-value">Small business owners, Retail clients, Growth partnerships</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="profile-info-label">Can Offer</div>
                        <div class="profile-info-value">AI coaching, Business strategy, Digital transformation</div>
                    </div>
                </div>
            </div>

            <div class="profile-section">
                <div class="profile-actions">
                    <button class="profile-action-btn primary" id="profileEmailBtn" onclick="sendMBCEmail('april@apriljsabral.com', 'April Sabral', 'AskApril AI')">
                         Send Email
                    </button>
                    <button class="profile-action-btn primary" id="profileChatBtn" onclick="startChat('april', 'April Sabral', 'AskApril AI')">
                         Start Chat
                    </button>
                    <a class="profile-action-btn secondary" id="profileLinkedInBtn" href="https://linkedin.com/in/apriljsabral" target="_blank">
                         LinkedIn Profile
                    </a>
                    <button class="profile-action-btn secondary" onclick="requestConnection('april', 'April Sabral')">
                         Connect
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase client
        const SUPABASE_URL = 'https://vsnvtujkkkbjpuuwxvyd.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZzbnZ0dWpra2tianB1dXd4dnlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MzUyNDYsImV4cCI6MjA3MTIxMTI0Nn0.GwWKrl_6zlIBvIaJs8NngoheF24nNzAfBO5_j_d1ogA';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global member data cache
        let currentMember = null;

        // Authentication check
        async function checkAuthentication() {
            try {
                // Get current session from Supabase
                const { data: { session }, error: sessionError } = await supabase.auth.getSession();

                if (!session || sessionError) {
                    console.log('No active session, redirecting to login...');
                    window.location.href = '/member-login';
                    return false;
                }

                console.log('Active session found for user:', session.user.email);

                // Fetch member profile from database
                const { data: member, error: memberError } = await supabase
                    .from('members')
                    .select('*')
                    .eq('auth_user_id', session.user.id)
                    .single();

                if (memberError || !member) {
                    console.error('Member profile not found:', memberError);
                    // Profile doesn't exist, redirect to login
                    alert('Member profile not found. Please contact support.');
                    await supabase.auth.signOut();
                    window.location.href = '/member-login';
                    return false;
                }

                // Store member data globally
                currentMember = member;
                console.log('Member profile loaded:', member);

                // Update UI with member info
                const fullName = `${member.first_name} ${member.last_name}`;
                const userNameElement = document.getElementById('userName');
                if (userNameElement) {
                    userNameElement.textContent = fullName;
                }

                const initials = `${member.first_name[0]}${member.last_name[0]}`.toUpperCase();
                const userAvatarElement = document.getElementById('userAvatar');
                if (userAvatarElement) {
                    userAvatarElement.textContent = initials;
                }

                // Show/hide admin panel based on user
                const isAdmin = member.email === 'info@miamibusinesscouncil.com';
                const adminNavItem = document.querySelector('[data-section="admin"]')?.parentElement;
                if (adminNavItem) {
                    adminNavItem.style.display = isAdmin ? 'block' : 'none';
                }

                return true;
            } catch (error) {
                console.error('Authentication check failed:', error);
                window.location.href = '/member-login';
                return false;
            }
        }

        // Logout function
        async function logout() {
            if (confirm('Are you sure you want to logout?')) {
                try {
                    await supabase.auth.signOut();
                    currentMember = null;
                    window.location.href = '/member-login';
                } catch (error) {
                    console.error('Logout error:', error);
                    // Force logout even if API call fails
                    window.location.href = '/member-login';
                }
            }
        }

        // Helper function to get current member data (backwards compatibility)
        function getMemberAuth() {
            if (currentMember) {
                return {
                    email: currentMember.email,
                    name: `${currentMember.first_name} ${currentMember.last_name}`,
                    loginTime: new Date().toISOString()
                };
            }
            return null;
        }

        // Handle magic link callback and authentication
        window.addEventListener('load', async () => {
            // Check if this is a magic link callback (has token in URL)
            const hashParams = new URLSearchParams(window.location.hash.substring(1));
            const searchParams = new URLSearchParams(window.location.search);

            const hasAuthToken = hashParams.has('access_token') ||
                                searchParams.has('token') ||
                                searchParams.has('code');

            if (hasAuthToken) {
                console.log('Magic link callback detected, processing authentication...');

                // Give Supabase time to process the auth callback
                await new Promise(resolve => setTimeout(resolve, 1000));

                // Clear URL parameters after processing
                window.history.replaceState({}, document.title, '/member-portal');
            }

            // Now check authentication
            const authenticated = await checkAuthentication();
            if (authenticated) {
                setupPhotoUpload();
                initializeChatSystem();
                updateMemberAvatars();
                await loadMemberProfile();

                // Initialize dashboard personalization after profile loads
                setTimeout(() => initializeDashboardPersonalization(), 800);
            }
        });

        // Show section function for quick actions
        function showSection(sectionId) {
            // Remove active class from all links and sections
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            
            // Add active class to corresponding nav link
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
            
            // Show corresponding section
            document.getElementById(sectionId).classList.add('active');
        }

        // Navigation functionality
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links and sections
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Show corresponding section
                const sectionId = this.getAttribute('data-section');
                document.getElementById(sectionId).classList.add('active');
                
                // Load photos when navigating to directory
                if (sectionId === 'directory') {
                    setTimeout(() => loadAllMemberPhotos(), 100);
                }
            });
        });

        // Search functionality
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.querySelector('.search-input');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const memberCards = document.querySelectorAll('.member-card');
                    
                    memberCards.forEach(card => {
                        const text = card.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            }
        });

        // Register button functionality
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.register-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (this.textContent.trim() === 'Register Now') {
                        window.open('https://luma.com/au2tl4nm', '_blank');
                    } else if (this.textContent.trim() === 'Edit Profile') {
                        alert('Profile editing feature coming soon!');
                    } else if (this.textContent.trim() === 'Coming Soon') {
                        alert('Event registration will open soon!');
                    }
                });
            });
        });

        // Member connection functionality
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.linkedin-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    if (this.href.includes('mailto:')) {
                        // Show connection confirmation for email connections
                        const memberName = this.href.split('Connect with ')[1]?.split('"')[0];
                        if (memberName && !confirm(`Send connection request to ${memberName}?`)) {
                            e.preventDefault();
                        }
                    }
                });
            });
        });

        // Dashboard stats animation
        document.addEventListener('DOMContentLoaded', function() {
            // Animate numbers on dashboard load
            setTimeout(() => {
                const statsElements = document.querySelectorAll('.dashboard-card p strong');
                statsElements.forEach(el => {
                    if (el.nextSibling && el.nextSibling.textContent.match(/\d+/)) {
                        el.parentElement.style.animation = 'fadeIn 0.5s ease-in';
                    }
                });
            }, 500);
        });

        // Smart Matching System - Global variable to store current matches
        let lastGeneratedMatches = [];

        function generateSmartMatches() {
            const matchResults = document.getElementById('smartMatchResults');
            
            // Enhanced loading with skeleton screens
            const loadingHtml = `
                <div class="skeleton-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div class="skeleton skeleton-avatar"></div>
                        <div style="flex: 1;">
                            <div class="skeleton skeleton-text skeleton-text-title"></div>
                            <div class="skeleton skeleton-text" style="width: 60%;"></div>
                        </div>
                        <div class="skeleton skeleton-text" style="width: 80px; height: 30px;"></div>
                    </div>
                    <div class="skeleton skeleton-text skeleton-text-body"></div>
                    <div class="skeleton skeleton-text skeleton-text-body"></div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <div class="skeleton skeleton-button"></div>
                        <div class="skeleton skeleton-button"></div>
                    </div>
                </div>
                <div class="skeleton-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div class="skeleton skeleton-avatar"></div>
                        <div style="flex: 1;">
                            <div class="skeleton skeleton-text skeleton-text-title"></div>
                            <div class="skeleton skeleton-text" style="width: 50%;"></div>
                        </div>
                        <div class="skeleton skeleton-text" style="width: 80px; height: 30px;"></div>
                    </div>
                    <div class="skeleton skeleton-text skeleton-text-body"></div>
                    <div class="skeleton skeleton-text skeleton-text-body"></div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <div class="skeleton skeleton-button"></div>
                        <div class="skeleton skeleton-button"></div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 2rem; color: #d4af37;">
                    <div class="loading-spinner"></div>
                    <div style="margin-top: 1rem; font-weight: 500;"> Analyzing member profiles and generating smart matches...</div>
                </div>
            `;
            
            matchResults.innerHTML = loadingHtml;
            
            // Simulate AI matching algorithm
            setTimeout(() => {
                const smartMatches = calculateIntelligentMatches();
                lastGeneratedMatches = smartMatches; // Store matches globally for profile viewing
                displaySmartMatches(smartMatches);
                updateMatchStats(smartMatches);
            }, 2000);
        }

        function calculateIntelligentMatches() {
            // Enhanced member database with smart matching profiles
            const membersWithProfiles = [
                {
                    id: 'april',
                    name: 'April Sabral',
                    company: 'Ask April AI Coaching',
                    industry: 'Business Consulting',
                    avatar: 'AS',
                    services: ['AI Coaching', 'Business Strategy', 'Digital Transformation'],
                    idealClient: {
                        industries: ['Retail', 'Professional Services', 'Small Business'],
                        companySize: ['small', 'medium'],
                        budget: ['10k-50k', '50k-100k'],
                        needsHelp: ['AI Implementation', 'Business Growth', 'Digital Strategy']
                    },
                    businessGoals: ['grow-revenue', 'help-businesses'],
                    location: 'miami',
                    workStyle: 'hybrid',
                    linkedin: 'https://linkedin.com/in/apriljsabral',
                    valueProposition: 'AI coaching that helps business owners leverage artificial intelligence for growth',
                    primaryOffering: 'AI coaching and business transformation consulting'
                },
                {
                    id: 'joy',
                    name: 'Joy Sabral',
                    company: 'Owner Retail',
                    industry: 'Retail',
                    avatar: 'JS',
                    services: ['Retail Consulting', 'Store Operations', 'Customer Experience'],
                    idealClient: {
                        industries: ['Retail', 'E-commerce', 'Consumer Goods'],
                        companySize: ['small', 'medium'],
                        budget: ['5k-25k', '25k-50k'],
                        needsHelp: ['Store Optimization', 'Customer Service', 'Retail Strategy']
                    },
                    businessGoals: ['grow-revenue', 'strategic-partnerships'],
                    location: 'miami',
                    workStyle: 'in-person',
                    linkedin: null,
                    valueProposition: 'Expert retail guidance to optimize store performance and customer satisfaction',
                    primaryOffering: 'Retail operations consulting and customer experience optimization'
                },
            ];

            // Current user profile simulation (would come from form data)
            const currentUser = {
                industry: 'Technology',
                services: ['Business Strategy', 'AI Consulting'],
                idealClient: {
                    industries: ['Real Estate', 'Marketing'],
                    companySize: ['small', 'medium'],
                    budget: ['50k-100k']
                },
                businessGoals: ['grow-revenue', 'strategic-partnerships']
            };

            // Calculate match scores using intelligent algorithm
            const matches = membersWithProfiles.map(member => {
                let score = 0;
                let matchReasons = [];
                let matchType = '';

                // Industry alignment (30% weight)
                if (currentUser.idealClient.industries.includes(member.industry)) {
                    score += 30;
                    matchReasons.push(`Perfect industry match: ${member.industry}`);
                    matchType = 'ideal-client';
                }

                if (member.idealClient.industries.includes(currentUser.industry)) {
                    score += 25;
                    matchReasons.push(`They're looking for your industry: ${currentUser.industry}`);
                    if (!matchType) matchType = 'service-provider';
                    else if (matchType === 'ideal-client') matchType = 'mutual';
                }

                // Services/needs alignment (25% weight)
                const serviceMatches = currentUser.services.some(service => 
                    member.idealClient.needsHelp?.some(need => 
                        need.toLowerCase().includes(service.toLowerCase()) ||
                        service.toLowerCase().includes(need.toLowerCase())
                    )
                );

                if (serviceMatches) {
                    score += 25;
                    matchReasons.push('Your services match their needs');
                }

                // Business goals alignment (20% weight)
                const goalAlignment = currentUser.businessGoals.some(goal => 
                    member.businessGoals.includes(goal)
                );

                if (goalAlignment) {
                    score += 20;
                    matchReasons.push('Aligned business goals');
                    if (!matchType) matchType = 'partnership';
                }

                // Budget/size compatibility (15% weight)
                const budgetMatch = currentUser.idealClient.budget.some(budget => 
                    member.idealClient.budget.includes(budget)
                );

                if (budgetMatch) {
                    score += 15;
                    matchReasons.push('Compatible budget ranges');
                }

                // Location proximity (10% weight)
                if (member.location === 'miami' || member.location === 'south-florida') {
                    score += 10;
                    matchReasons.push('Local Miami area');
                }

                return {
                    ...member,
                    matchScore: Math.min(score, 98), // Cap at 98%
                    matchReasons: matchReasons.slice(0, 3), // Top 3 reasons
                    matchType: matchType || 'networking',
                    priority: score > 80 ? 'high' : score > 60 ? 'medium' : 'low',
                    mutualBenefit: matchType === 'mutual'
                };
            }).filter(match => match.matchScore > 40) // Only show matches above 40%
              .sort((a, b) => b.matchScore - a.matchScore);

            return matches;
        }

        function displaySmartMatches(matches) {
            const matchResults = document.getElementById('smartMatchResults');
            
            if (matches.length === 0) {
                matchResults.innerHTML = '<div style="text-align: center; padding: 2rem; color: #ccc;">No strong matches found. Try updating your profile to get better results.</div>';
                return;
            }

            const matchesHtml = matches.map(match => `
                <div class="match-card" data-match-type="${match.matchType}" data-industry="${match.industry}" data-score="${match.matchScore}">
                    <div class="match-header">
                        <div class="member-avatar">${match.avatar}</div>
                        <div>
                            <h4>${match.name}</h4>
                            <p>${match.company}  ${match.industry}</p>
                        </div>
                        <div style="text-align: right;">
                            <div class="match-score">${match.matchScore}%</div>
                            <div style="font-size: 0.8em; color: #d4af37; margin-top: 0.25rem;">${getMatchTypeLabel(match.matchType)}</div>
                            ${match.mutualBenefit ? '<div style="font-size: 0.7em; color: #51cf66;"> MUTUAL</div>' : ''}
                        </div>
                    </div>
                    <div class="match-details">
                        <p><strong>What they offer:</strong> ${match.services.join(', ')}</p>
                        <p><strong>What they need:</strong> ${match.idealClient.needsHelp?.join(', ') || 'Various business support'}</p>
                        <p><strong>Why this match:</strong> ${match.matchReasons.join(', ')}</p>
                        ${match.valueProposition ? `<p><strong>Their value:</strong> ${match.valueProposition}</p>` : ''}
                    </div>
                    <div class="match-actions">
                        <button class="connect-btn" onclick="sendSmartIntro('${match.id}', '${match.name}')">Smart Intro</button>
                        <button class="linkedin-btn" onclick="${match.linkedin ? `window.open('${match.linkedin}', '_blank')` : `openSmartMatchProfile('${match.id}')`}">
                            ${match.linkedin ? 'LinkedIn' : 'View Profile'}
                        </button>
                        <button class="register-btn" onclick="scheduleMeeting('${match.id}')" style="padding: 0.5rem 1rem; margin-left: 0.5rem;">
                            Schedule Meet
                        </button>
                    </div>
                </div>
            `).join('');

            matchResults.innerHTML = matchesHtml;
        }

        function getMatchTypeLabel(matchType) {
            const labels = {
                'ideal-client': ' IDEAL CLIENT',
                'service-provider': ' SERVICE FOR YOU',
                'mutual': ' MUTUAL BENEFIT',
                'partnership': ' PARTNERSHIP',
                'networking': ' NETWORKING'
            };
            return labels[matchType] || ' NETWORKING';
        }

        function updateMatchStats(matches) {
            document.getElementById('totalMatches').textContent = matches.length;
            document.getElementById('highPriorityMatches').textContent = matches.filter(m => m.priority === 'high').length;
            document.getElementById('newMatches').textContent = Math.floor(matches.length * 0.3); // Simulate new matches
        }

        function filterMatches() {
            const matchType = document.getElementById('matchTypeFilter').value;
            const industry = document.getElementById('industryFilter').value;
            const scoreRange = document.getElementById('scoreFilter').value;
            const availability = document.getElementById('availabilityFilter').value;

            const allCards = document.querySelectorAll('.match-card');
            let visibleCount = 0;

            allCards.forEach(card => {
                let show = true;

                // Filter by match type
                if (matchType !== 'all' && !card.dataset.matchType.includes(matchType)) {
                    show = false;
                }

                // Filter by industry
                if (industry !== 'all' && !card.dataset.industry.includes(industry)) {
                    show = false;
                }

                // Filter by score
                if (scoreRange !== 'all') {
                    const score = parseInt(card.dataset.score);
                    if (scoreRange === 'high' && score < 90) show = false;
                    if (scoreRange === 'good' && (score < 75 || score >= 90)) show = false;
                    if (scoreRange === 'fair' && (score < 60 || score >= 75)) show = false;
                }

                card.style.display = show ? 'block' : 'none';
                if (show) visibleCount++;
            });

            // Update visible count
            const matchResults = document.getElementById('smartMatchResults');
            if (visibleCount === 0) {
                matchResults.innerHTML = '<div style="text-align: center; padding: 2rem; color: #ccc;">No matches found for current filters. Try adjusting your criteria.</div>';
            }
        }

        function sendSmartIntro(memberId, memberName) {
            // AI-generated introduction message
            const introMessage = `Hi ${memberName}! I came across your profile through Miami Business Council's smart matching system. Based on our business profiles, it looks like we might have some interesting synergies to explore. Would you be open to a brief call to discuss potential collaboration opportunities?`;
            
            if (confirm(`Send this smart introduction to ${memberName}?\n\n"${introMessage}"`)) {
                alert(`Smart introduction sent to ${memberName}! They'll receive a personalized message highlighting why you're a great match.`);
                // In real implementation, this would send via the chat system or email
            }
        }

        function scheduleMeeting(memberId) {
            alert('Meeting scheduling feature coming soon! For now, use the Smart Intro to connect and suggest a meeting time.');
        }

        function viewMemberProfile(memberId) {
            alert(`Detailed member profile viewer coming soon! This would show ${memberId}'s complete business profile and portfolio.`);
        }

        function openSmartMatchProfile(matchId) {
            // Find the match data from the smart matches array
            const match = lastGeneratedMatches.find(m => m.id === matchId);
            if (!match) {
                alert('Member profile not found. Please refresh the matches and try again.');
                return;
            }

            // Convert smart match data to the format expected by openMemberProfile
            const memberName = match.name;
            const memberTitle = match.services?.[0] || 'Business Professional';
            const memberCompany = match.company;
            const memberAvatar = match.avatar;
            const memberTags = match.services || [];
            const memberEmail = `${match.id}@member.com`; // Placeholder email
            const memberLinkedIn = match.linkedin || '';

            // Call the existing openMemberProfile function with proper parameters
            openMemberProfile(
                matchId, 
                memberName, 
                memberTitle, 
                memberCompany, 
                memberAvatar, 
                memberTags, 
                memberEmail, 
                memberLinkedIn
            );
        }


        function scheduleMatchNotifications() {
            if (confirm('Enable weekly smart match notifications?')) {
                alert(' Weekly match alerts enabled! You\'ll receive email updates every Monday with new matches and opportunities.');
            }
        }

        // Initialize smart matches when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-generate smart matches for demo
            setTimeout(() => {
                if (document.getElementById('smartMatchResults')) {
                    generateSmartMatches();
                }
            }, 1000);
        });

        // Business matching functionality
        function toggleTag(tag) {
            tag.classList.toggle('active');
            // Auto-update matches when preferences change
            setTimeout(findMatches, 500);
        }

        function findMatches() {
            const matchResults = document.getElementById('matchResults');
            const loadingHtml = '<div style="text-align: center; padding: 2rem; color: #ccc;"> Finding new business matches...</div>';
            
            matchResults.innerHTML = loadingHtml;
            
            // Simulate matching algorithm
            setTimeout(() => {
                const matches = generateMatches();
                displayMatches(matches);
            }, 1500);
        }

        function generateMatches() {
            // Get user preferences
            const lookingFor = Array.from(document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active'))
                .map(tag => tag.textContent);
            const canOffer = Array.from(document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active'))
                .map(tag => tag.textContent);
            
            // Sample member database for matching
            const members = [
                {
                    name: 'April Sabral',
                    company: 'Ask April AI Coaching',
                    industry: 'Business Consulting',
                    avatar: 'AS',
                    lookingFor: ['Small business owners', 'Retail clients', 'Growth partnerships'],
                    canOffer: ['AI coaching', 'Business strategy', 'Digital transformation'],
                    linkedin: 'https://linkedin.com/in/apriljsabral',
                    score: 95
                },
                {
                    name: 'Joy Sabral',
                    company: 'Owner Retail',
                    industry: 'Retail Consulting',
                    avatar: 'JS',
                    lookingFor: ['Retail businesses', 'E-commerce clients', 'Strategic partners'],
                    canOffer: ['Retail expertise', 'Store optimization', 'Customer experience'],
                    linkedin: null,
                    score: 88
                },
            ];

            // Calculate match scores based on complementary needs
            return members.map(member => {
                let matchReasons = [];
                
                // Check if what they're looking for matches what user can offer
                const mutualBenefit1 = member.lookingFor.some(need => 
                    canOffer.some(offer => offer.toLowerCase().includes(need.toLowerCase()) || 
                                         need.toLowerCase().includes(offer.toLowerCase())));
                
                // Check if what user is looking for matches what they can offer  
                const mutualBenefit2 = lookingFor.some(need =>
                    member.canOffer.some(offer => offer.toLowerCase().includes(need.toLowerCase()) ||
                                                need.toLowerCase().includes(offer.toLowerCase())));

                if (mutualBenefit1) matchReasons.push('You can help with their needs');
                if (mutualBenefit2) matchReasons.push('They can help with your needs');
                if (mutualBenefit1 && mutualBenefit2) matchReasons.push('Mutual partnership potential');

                return {
                    ...member,
                    matchReason: matchReasons.length > 0 ? matchReasons.join(', ') : 'Industry synergy and networking opportunity'
                };
            }).sort((a, b) => b.score - a.score);
        }

        function displayMatches(matches) {
            const matchResults = document.getElementById('matchResults');
            
            if (matches.length === 0) {
                matchResults.innerHTML = '<div style="text-align: center; padding: 2rem; color: #ccc;">No matches found. Try adjusting your preferences.</div>';
                return;
            }

            const matchesHtml = matches.map(match => `
                <div class="match-card">
                    <div class="match-header">
                        <div class="member-avatar">${match.avatar}</div>
                        <div>
                            <h4>${match.name}</h4>
                            <p>${match.company}  ${match.industry}</p>
                        </div>
                        <div class="match-score">${match.score}%</div>
                    </div>
                    <div class="match-details">
                        <p><strong>Looking for:</strong> ${match.lookingFor.join(', ')}</p>
                        <p><strong>Can offer:</strong> ${match.canOffer.join(', ')}</p>
                        <p><strong>Match reason:</strong> ${match.matchReason}</p>
                    </div>
                    <div class="match-actions">
                        <button class="connect-btn" onclick="connectWithMember('${match.name}')">Connect</button>
                        <button class="linkedin-btn" onclick="${match.linkedin ? `window.open('${match.linkedin}', '_blank')` : `alert('LinkedIn profile coming soon')`}">LinkedIn</button>
                    </div>
                </div>
            `).join('');

            matchResults.innerHTML = matchesHtml;
        }

        function connectWithMember(memberName) {
            if (confirm(`Send a connection request to ${memberName}?`)) {
                // In a real app, this would send an email or notification
                alert(`Connection request sent to ${memberName}! They'll be notified via email.`);
            }
        }

        function saveProfile() {
            // Get all form data
            const profileData = {
                name: document.querySelector('input[value="John Smith"]').value,
                company: document.querySelector('input[value="Smith Consulting LLC"]').value,
                title: document.querySelector('input[value="Founder & CEO"]').value,
                industry: document.querySelector('select').value,
                linkedin: document.querySelector('input[type="url"]').value,
                lookingFor: Array.from(document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active')).map(tag => tag.textContent),
                canOffer: Array.from(document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active')).map(tag => tag.textContent),
                companySize: document.querySelector('input[name="company-size"]:checked').value
            };

            // In a real app, this would save to database
            localStorage.setItem('memberProfile', JSON.stringify(profileData));
            alert('Profile saved successfully! Your matching preferences have been updated.');
        }

        function shareProfile() {
            const profileUrl = window.location.href.split('?')[0] + '?member=johnsmith';
            
            if (navigator.share) {
                navigator.share({
                    title: 'My Miami Business Council Profile',
                    text: 'Connect with me on Miami Business Council',
                    url: profileUrl
                });
            } else {
                navigator.clipboard.writeText(profileUrl).then(() => {
                    alert('Profile link copied to clipboard!');
                });
            }
        }

        // Photo Upload Functionality
        function setupPhotoUpload() {
            const personalUpload = document.getElementById('personalPhotoUpload');
            const companyUpload = document.getElementById('companyLogoUpload');

            personalUpload.addEventListener('change', (e) => handlePhotoUpload(e, 'personal'));
            companyUpload.addEventListener('change', (e) => handlePhotoUpload(e, 'company'));

            // Load existing photos from localStorage
            loadExistingPhotos();
        }

        function handlePhotoUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            // Validate file
            const maxSize = 5 * 1024 * 1024; // 5MB
            if (file.size > maxSize) {
                alert('Photo must be smaller than 5MB');
                return;
            }

            if (!file.type.startsWith('image/')) {
                alert('Please select an image file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const imageData = e.target.result;
                displayPhoto(imageData, type);
                savePhotoToStorage(imageData, type);
            };
            reader.readAsDataURL(file);
        }

        function displayPhoto(imageData, type) {
            const previewId = type === 'personal' ? 'personalPhotoPreview' : 'companyLogoPreview';
            const removeId = type === 'personal' ? 'removePersonalPhoto' : 'removeCompanyLogo';
            
            const preview = document.getElementById(previewId);
            const removeBtn = document.getElementById(removeId);

            preview.innerHTML = `<img src="${imageData}" alt="${type} photo">`;
            removeBtn.style.display = 'inline-block';
            
            // Update avatars throughout portal if this is a personal photo
            if (type === 'personal') {
                updateMemberAvatars();
            }
        }

        function removePhoto(type) {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;
            
            try {
                const auth = JSON.parse(memberAuth);
                const memberEmail = auth.email;
                
                const previewId = type === 'personal' ? 'personalPhotoPreview' : 'companyLogoPreview';
                const removeId = type === 'personal' ? 'removePersonalPhoto' : 'removeCompanyLogo';
                const storageKey = type === 'personal' ? 
                    `memberPersonalPhoto_${memberEmail}` : 
                    `memberCompanyLogo_${memberEmail}`;
                
                const preview = document.getElementById(previewId);
                const removeBtn = document.getElementById(removeId);
                const icon = type === 'personal' ? '' : '';
                const text = type === 'personal' ? 'No photo uploaded' : 'No logo uploaded';

                preview.innerHTML = `
                    <div class="photo-placeholder">
                        <span class="photo-icon">${icon}</span>
                        <p>${text}</p>
                    </div>
                `;
                removeBtn.style.display = 'none';
                localStorage.removeItem(storageKey);
                
                // Reset avatars throughout portal if this is a personal photo
                if (type === 'personal') {
                    resetMemberAvatarsToInitials();
                }
            } catch (error) {
                console.error('Error removing photo:', error);
            }
        }
        
        // Reset member avatars back to initials when photo is removed
        function resetMemberAvatarsToInitials() {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;

            try {
                const auth = JSON.parse(memberAuth);
                const initials = auth.name.split(' ').map(n => n[0]).join('').toUpperCase();
                
                // Reset header avatar
                const headerAvatar = document.getElementById('userAvatar');
                if (headerAvatar) {
                    headerAvatar.style.backgroundImage = '';
                    headerAvatar.textContent = initials;
                }

                // Reset member directory avatars
                const memberCards = document.querySelectorAll('.member-card');
                memberCards.forEach(card => {
                    const memberName = card.querySelector('.member-info h3')?.textContent;
                    if (memberName && memberName.includes(auth.name.split(' ')[0])) {
                        const avatar = card.querySelector('.member-avatar');
                        if (avatar) {
                            avatar.style.backgroundImage = '';
                            avatar.textContent = initials;
                        }
                    }
                });

                // Reset chat avatars
                const chatAvatars = document.querySelectorAll('.message.own .message-avatar');
                chatAvatars.forEach(avatar => {
                    avatar.style.backgroundImage = '';
                    avatar.textContent = 'ME';
                });
            } catch (error) {
                console.error('Error resetting member avatars:', error);
            }
        }

        function savePhotoToStorage(imageData, type) {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;
            
            try {
                const auth = JSON.parse(memberAuth);
                const memberEmail = auth.email;
                
                // Make storage keys member-specific
                const storageKey = type === 'personal' ? 
                    `memberPersonalPhoto_${memberEmail}` : 
                    `memberCompanyLogo_${memberEmail}`;
                localStorage.setItem(storageKey, imageData);
            } catch (error) {
                console.error('Error saving photo:', error);
            }
        }

        function loadExistingPhotos() {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;
            
            try {
                const auth = JSON.parse(memberAuth);
                const memberEmail = auth.email;
                
                // Load member-specific photos
                const personalPhoto = localStorage.getItem(`memberPersonalPhoto_${memberEmail}`);
                const companyLogo = localStorage.getItem(`memberCompanyLogo_${memberEmail}`);

                if (personalPhoto) {
                    displayPhoto(personalPhoto, 'personal');
                }

                if (companyLogo) {
                    displayPhoto(companyLogo, 'company');
                }
            } catch (error) {
                console.error('Error loading photos:', error);
            }
        }

        // Update member avatars throughout the portal with uploaded photos
        function updateMemberAvatars() {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;

            try {
                const auth = JSON.parse(memberAuth);
                const memberEmail = auth.email;
                const personalPhoto = localStorage.getItem(`memberPersonalPhoto_${memberEmail}`);
                
                if (personalPhoto) {
                    // Update header avatar
                    const headerAvatar = document.getElementById('userAvatar');
                    if (headerAvatar) {
                        headerAvatar.style.backgroundImage = `url(${personalPhoto})`;
                        headerAvatar.style.backgroundSize = 'cover';
                        headerAvatar.style.backgroundPosition = 'center';
                        headerAvatar.textContent = ''; // Remove initials when photo is present
                    }

                    // Update any member avatars in the member directory that match current user
                    const memberCards = document.querySelectorAll('.member-card');
                    memberCards.forEach(card => {
                        const memberName = card.querySelector('.member-info h3')?.textContent;
                        if (memberName && memberName.includes(auth.name.split(' ')[0])) {
                            const avatar = card.querySelector('.member-avatar');
                            if (avatar) {
                                avatar.style.backgroundImage = `url(${personalPhoto})`;
                                avatar.style.backgroundSize = 'cover';
                                avatar.style.backgroundPosition = 'center';
                                avatar.textContent = ''; // Remove initials when photo is present
                            }
                        }
                    });

                    // Update chat avatars
                    const chatAvatars = document.querySelectorAll('.message.own .message-avatar');
                    chatAvatars.forEach(avatar => {
                        avatar.style.backgroundImage = `url(${personalPhoto})`;
                        avatar.style.backgroundSize = 'cover';
                        avatar.style.backgroundPosition = 'center';
                        avatar.textContent = ''; // Remove 'ME' text when photo is present
                    });
                }

                // Also load photos for all members in directory (not just current user)
                loadAllMemberPhotos();
            } catch (error) {
                console.error('Error updating member avatars:', error);
            }
        }

        // Load photos for all members in the directory
        function loadAllMemberPhotos() {
            // Define member email mappings for the directory
            const memberMappings = {
                'April Sabral': 'april@retailu.ca',
                'Joy Sabral': 'sabral@me.com'
            };

            const memberCards = document.querySelectorAll('.member-card');
            memberCards.forEach(card => {
                const memberNameElement = card.querySelector('.member-info h3');
                if (!memberNameElement) return;

                const memberName = memberNameElement.textContent.trim();
                const memberEmail = memberMappings[memberName];
                
                if (memberEmail) {
                    const memberPhoto = localStorage.getItem(`memberPersonalPhoto_${memberEmail}`);
                    if (memberPhoto) {
                        const avatar = card.querySelector('.member-avatar');
                        if (avatar) {
                            avatar.style.backgroundImage = `url(${memberPhoto})`;
                            avatar.style.backgroundSize = 'cover';
                            avatar.style.backgroundPosition = 'center';
                            avatar.textContent = ''; // Remove initials when photo is present
                        }
                    }
                }
            });
        }

        // Member Profile Modal Functions
        function openMemberProfile(id, name, title, company, avatar, tags, email, linkedin) {
            // Update modal content with member data
            document.getElementById('profileAvatarLarge').textContent = avatar;
            document.getElementById('profileName').textContent = name;
            document.getElementById('profileTitle').textContent = title;
            document.getElementById('profileCompany').textContent = company;
            document.getElementById('profileIndustry').textContent = tags.join(', ');
            
            // Update tags
            const tagsContainer = document.getElementById('profileTags');
            tagsContainer.innerHTML = tags.map(tag => `<span class="profile-tag">${tag}</span>`).join('');
            
            // Update action buttons
            const emailBtn = document.getElementById('profileEmailBtn');
            emailBtn.setAttribute('onclick', `sendMBCEmail('${email}', '${name}', '${company}')`);
            
            const chatBtn = document.getElementById('profileChatBtn');
            chatBtn.setAttribute('onclick', `startChat('${id}', '${name}', '${company}')`);
            
            const linkedInBtn = document.getElementById('profileLinkedInBtn');
            if (linkedin) {
                linkedInBtn.href = linkedin;
                linkedInBtn.style.display = 'inline-flex';
            } else {
                linkedInBtn.style.display = 'none';
            }
            
            // Show modal
            document.getElementById('memberProfileModal').style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeMemberProfile() {
            document.getElementById('memberProfileModal').style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        function openLinkedInFromCard(button) {
            // Find the parent member card
            const memberCard = button.closest('.member-card');
            if (!memberCard) return;
            
            // Extract the LinkedIn URL from the onclick attribute
            const onclickAttr = memberCard.getAttribute('onclick');
            const linkedinUrlMatch = onclickAttr.match(/'(https:\/\/linkedin\.com\/in\/[^']+)'/);
            
            if (linkedinUrlMatch && linkedinUrlMatch[1]) {
                window.open(linkedinUrlMatch[1], '_blank');
            } else {
                alert('LinkedIn profile coming soon!');
            }
        }

        function startChat(memberId, memberName, memberCompany) {
            closeMemberProfile();
            showSection('messages');
            // Open the chat with this member
            openChat(memberId, memberName, memberCompany);
        }

        function requestConnection(memberId, memberName) {
            if (confirm(`Send a connection request to ${memberName}?`)) {
                // Add to connection requests (in real app, this would be stored in database)
                const connections = JSON.parse(localStorage.getItem('connectionRequests') || '[]');
                connections.push({
                    id: memberId,
                    name: memberName,
                    timestamp: new Date().toISOString(),
                    status: 'sent'
                });
                localStorage.setItem('connectionRequests', JSON.stringify(connections));
                
                alert(`Connection request sent to ${memberName}! They'll be notified and can accept or decline your request.`);
                closeMemberProfile();
                updateConnectionBadge();
            }
        }

        // Connection management functions
        function acceptConnection(memberId, memberName) {
            if (confirm(`Accept connection request from ${memberName}?`)) {
                // Remove from pending requests
                const requestElement = event.target.closest('.connection-request');
                requestElement.style.opacity = '0.5';
                requestElement.style.transform = 'scale(0.95)';
                
                setTimeout(() => {
                    requestElement.remove();
                    updateConnectionStats();
                }, 300);
                
                // Start chat automatically
                alert(` You're now connected with ${memberName}! You can now chat directly.`);
                
                // Update badge count
                updateConnectionBadge();
            }
        }

        function declineConnection(memberId, memberName) {
            if (confirm(`Decline connection request from ${memberName}?`)) {
                const requestElement = event.target.closest('.connection-request');
                requestElement.style.opacity = '0.5';
                requestElement.style.transform = 'scale(0.95)';
                
                setTimeout(() => {
                    requestElement.remove();
                    updateConnectionStats();
                }, 300);
                
                alert(`Connection request from ${memberName} has been declined.`);
                
                // Update badge count
                updateConnectionBadge();
            }
        }

        function updateConnectionStats() {
            const pendingRequests = document.querySelectorAll('.connection-request').length;
            document.getElementById('incomingRequests').textContent = pendingRequests;
            
            if (pendingRequests === 0) {
                const requestsContainer = document.getElementById('connectionRequests');
                requestsContainer.innerHTML = '<div style="text-align: center; padding: 2rem; color: #ccc;"> No pending connection requests. Great job staying connected!</div>';
            }
        }

        function updateConnectionBadge() {
            const pendingRequests = document.querySelectorAll('.connection-request').length;
            const badge = document.getElementById('connectionNotificationBadge');
            
            if (pendingRequests > 0) {
                badge.textContent = pendingRequests;
                badge.style.display = 'inline-block';
            } else {
                badge.style.display = 'none';
            }
        }

        function showPendingRequests() {
            showSection('connections');
        }

        // Initialize connection badge on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateConnectionBadge();
        });

        // Admin Panel Functions
        function addNewMember() {
            const firstName = document.getElementById('newMemberFirstName').value.trim();
            const lastName = document.getElementById('newMemberLastName').value.trim();
            const email = document.getElementById('newMemberEmail').value.trim();
            const personalMessage = document.getElementById('newMemberMessage').value.trim();

            // Validate required fields
            if (!firstName || !lastName || !email) {
                alert('Please fill in all required fields (First Name, Last Name, Email)');
                return;
            }

            // Generate access code
            const accessCode = generateAccessCode();

            // In a real app, this would call your API
            const memberData = {
                firstName,
                lastName,
                email,
                personalMessage,
                accessCode,
                dateAdded: new Date().toISOString()
            };

            // Save member data to localStorage (minimal profile - they'll complete the rest)
            localStorage.setItem(`newMember_${email}`, JSON.stringify({
                name: `${firstName} ${lastName}`,
                company: 'To be completed',
                title: 'To be completed',
                industry: 'To be completed',
                accessCode: accessCode,
                dateAdded: new Date().toISOString(),
                status: 'pending',
                profileIncomplete: true
            }));

            // Send invitation email
            sendMemberInvitation(memberData);

            // Clear form
            clearNewMemberForm();

            // Refresh member list to show new member
            setTimeout(() => {
                refreshMemberList();
                console.log('Member saved to localStorage:', `newMember_${email}`);
                console.log('Data stored:', localStorage.getItem(`newMember_${email}`));
            }, 500);

            alert(` Member invitation sent to ${firstName} ${lastName} at ${email}!\n\nAccess Code: ${accessCode}\n\nThey will receive an email with portal access instructions.`);
        }

        function generateAccessCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function sendMemberInvitation(memberData) {
            // Call the email API
            fetch('/api/email-handler', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    type: 'welcome',
                    email: memberData.email,
                    firstName: memberData.firstName,
                    lastName: memberData.lastName,
                    membershipType: 'Individual',
                    accessCode: memberData.accessCode,
                    portalUrl: 'https://miamibusinesscouncil.com/member-login',
                    company: memberData.company
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Welcome email sent:', data);
            })
            .catch(error => {
                console.error('Error sending welcome email:', error);
                alert('Member added but email failed to send. Please manually share their access code: ' + memberData.accessCode);
            });
        }

        function clearNewMemberForm() {
            document.getElementById('newMemberFirstName').value = '';
            document.getElementById('newMemberLastName').value = '';
            document.getElementById('newMemberEmail').value = '';
            document.getElementById('newMemberMessage').value = '';
        }

        function previewInvitation() {
            const firstName = document.getElementById('newMemberFirstName').value.trim();
            const personalMessage = document.getElementById('newMemberMessage').value.trim();

            if (!firstName) {
                alert('Please enter a first name to preview the invitation');
                return;
            }

            let preview = `Subject: Welcome to Miami Business Council - Your Portal Access\n\n`;
            preview += `Hi ${firstName},\n\n`;
            preview += `Welcome to Miami Business Council! Your membership is now active.\n\n`;
            
            if (personalMessage) {
                preview += `Personal note: "${personalMessage}"\n\n`;
            }
            
            preview += `Portal Access:\n`;
            preview += ` Email: [Member's Email]\n`;
            preview += ` Access Code: [Auto-Generated]\n`;
            preview += ` Login: https://miamibusinesscouncil.com/member-login\n\n`;
            preview += `Next Event: January 28th, 2025  9:00 AM\n`;
            preview += `Miami Design District\n\n`;
            preview += `Questions? Contact us at info@miamibusinesscouncil.com`;

            alert(preview);
        }

        function sendProfileReminder(email, memberName) {
            if (confirm(`Send profile completion reminder to ${memberName}?`)) {
                // Call the email API for profile reminder
                fetch('/api/email-handler', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        type: 'welcome',
                        email: email,
                        firstName: memberName.split(' ')[0],
                        lastName: memberName.split(' ')[1] || '',
                        membershipType: 'Individual',
                        accessCode: 'LOGIN-2025',
                        portalUrl: 'https://miamibusinesscouncil.com/member-login',
                        company: 'Member Company'
                    })
                })
                .then(response => response.json())
                .then(data => {
                    alert(` Profile completion reminder sent to ${memberName}!`);
                })
                .catch(error => {
                    console.error('Error sending reminder:', error);
                    alert(`Profile reminder email sent to ${memberName}!`);
                });
            }
        }

        function resetMemberPassword(email) {
            if (confirm(`Generate new access code for ${email}?`)) {
                const newAccessCode = generateAccessCode();
                
                // Call the password reset API
                fetch('/api/email-handler', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        type: 'password-reset',
                        email: email
                    })
                })
                .then(response => response.json())
                .then(data => {
                    alert(` New access code generated: ${newAccessCode}\n\nPassword reset email sent to ${email}`);
                })
                .catch(error => {
                    console.error('Error sending reset email:', error);
                    alert(`New access code: ${newAccessCode}\n\nPlease manually share with the member.`);
                });
            }
        }

        function viewMemberActivity(memberId) {
            alert(` Member Activity Report\n\n Login History: 5 times this month\n Profile Updates: 2 recent changes\n Connections Made: 3 active\n Messages Sent: 12 total\n Events Attended: 2 this year\n\nDetailed analytics coming soon!`);
        }

        function sendBulkWelcomeEmails() {
            if (confirm('Send welcome emails to all new members?')) {
                alert(' Bulk welcome emails sent to 3 members!\n\n Welcome messages delivered\n Portal access instructions included\n Event invitations attached');
            }
        }

        function sendEventReminders() {
            if (confirm('Send event reminders for January 28th breakfast?')) {
                alert(' Event reminders sent!\n\n 3 members notified\n RSVP links included\n Calendar invites attached');
            }
        }

        function exportMemberData() {
            alert(' Member data export initiated!\n\n Complete member profiles\n Activity statistics\n Connection mapping\n Email engagement data\n\nDownload will begin shortly...');
        }

        // Admin Member List Functions
        function refreshMemberList() {
            const container = document.getElementById('memberListContainer');
            
            // Show loading state
            container.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #ccc;">
                    <div class="loading-spinner"></div>
                    <div style="margin-top: 1rem;">Loading member list...</div>
                </div>
            `;

            // Get current members from the smart matching data
            const memberEmails = ['april@retailu.ca', 'sabral@me.com'];
            const memberCredentials = {
                'info@miamibusinesscouncil.com': { name: 'MBC Admin', company: 'Miami Business Council', status: 'active' },
                'april@retailu.ca': { name: 'April Sabral', company: 'AskApril AI', status: 'active' },
                'sabral@me.com': { name: 'Joy Sabral', company: 'Owner Retail', status: 'active' }
            };

            // Get dynamic member data from localStorage
            const dynamicMembers = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('newMember_')) {
                    try {
                        const memberData = JSON.parse(localStorage.getItem(key));
                        dynamicMembers.push({
                            email: key.replace('newMember_', ''),
                            name: memberData.name,
                            company: memberData.company || 'N/A',
                            status: 'pending'
                        });
                    } catch (e) {
                        console.warn('Error parsing member data:', e);
                    }
                }
            }

            // Combine all members
            const allMembers = [];
            Object.keys(memberCredentials).forEach(email => {
                const member = memberCredentials[email];
                allMembers.push({
                    email: email,
                    name: member.name,
                    company: member.company,
                    status: member.status,
                    joinDate: 'Jan 2025'
                });
            });

            // Add dynamic members
            dynamicMembers.forEach(member => {
                allMembers.push({
                    email: member.email,
                    name: member.name,
                    company: member.company,
                    status: member.status,
                    joinDate: 'Recently Added'
                });
            });

            // Calculate summary stats
            const totalMembers = allMembers.length;
            const activeMembers = allMembers.filter(m => m.status === 'active').length;
            const pendingMembers = allMembers.filter(m => m.status === 'pending').length;

            // Generate member list HTML
            setTimeout(() => {
                const memberListHTML = `
                    <div class="member-list-summary">
                        <div class="summary-item">
                            <div class="summary-number">${totalMembers}</div>
                            <div class="summary-label">Total Members</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${activeMembers}</div>
                            <div class="summary-label">Active Members</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${pendingMembers}</div>
                            <div class="summary-label">Pending</div>
                        </div>
                    </div>
                    
                    <table class="member-list-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Company</th>
                                <th>Status</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${allMembers.map(member => `
                                <tr>
                                    <td><strong>${member.name}</strong></td>
                                    <td>${member.email}</td>
                                    <td>${member.company}</td>
                                    <td>
                                        <span class="member-status ${member.status}">
                                            ${member.status === 'active' ? ' Active' : ' Pending'}
                                        </span>
                                    </td>
                                    <td>${member.joinDate}</td>
                                    <td class="member-actions-cell">
                                        <button class="member-action-btn" onclick="viewMemberActivity('${member.email}')" title="View Activity"></button>
                                        <button class="member-action-btn" onclick="resetMemberPassword('${member.email}')" title="Reset Password"></button>
                                        ${member.status === 'pending' ? 
                                            `<button class="member-action-btn" onclick="sendProfileReminder('${member.email}')" title="Send Reminder"></button>` : 
                                            ''
                                        }
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                container.innerHTML = memberListHTML;
                
                // Update admin dashboard member count
                const adminTotalMemberCountElement = document.getElementById('adminTotalMemberCount');
                if (adminTotalMemberCountElement) {
                    adminTotalMemberCountElement.textContent = totalMembers;
                }
            }, 1000);
        }

        // Load member-specific profile data
        async function loadMemberProfile() {
            if (!currentMember) {
                console.warn('No member data available');
                return;
            }

            try {
                // Populate form fields from Supabase data
                const fullName = `${currentMember.first_name} ${currentMember.last_name}`;

                if (document.getElementById('memberName')) {
                    document.getElementById('memberName').value = fullName;
                }
                if (document.getElementById('memberCompany')) {
                    document.getElementById('memberCompany').value = currentMember.company_name || '';
                }
                if (document.getElementById('memberTitle')) {
                    document.getElementById('memberTitle').value = currentMember.job_title || '';
                }
                if (document.getElementById('memberIndustry')) {
                    document.getElementById('memberIndustry').value = currentMember.industry || '';
                }
                if (document.getElementById('memberLinkedIn')) {
                    document.getElementById('memberLinkedIn').value = currentMember.linkedin_url || '';
                }

                // Also check localStorage for additional data not in database yet
                const profileKey = `memberProfile_${currentMember.email}`;
                const savedProfile = localStorage.getItem(profileKey);

                if (savedProfile) {
                    const profile = JSON.parse(savedProfile);
                    // Fill in any fields that aren't in the database yet
                    if (!currentMember.job_title && profile.title && document.getElementById('memberTitle')) {
                        document.getElementById('memberTitle').value = profile.title;
                    }
                }

                // Load member-specific photos
                loadExistingPhotos();

                // Update profile progress
                setTimeout(() => updateProfileProgress(), 500);
                
            } catch (error) {
                console.error('Error loading member profile:', error);
            }
        }

        // Dashboard personalization initialization
        function initializeDashboardPersonalization() {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;

            try {
                const auth = JSON.parse(memberAuth);
                
                // Update personalized welcome card
                updatePersonalizedWelcome(auth);
                
                // Update dashboard stats
                updateDashboardStats(auth);
                
                // Update insights
                updateDailyInsights(auth);
                
                // Update profile strength
                calculateProfileStrength(auth);
                
            } catch (error) {
                console.error('Error initializing dashboard personalization:', error);
            }
        }

        // Update personalized welcome message and user info
        function updatePersonalizedWelcome(auth) {
            // Update user name in welcome card
            const dashboardUserName = document.getElementById('dashboardUserName');
            if (dashboardUserName) {
                const firstName = auth.name.split(' ')[0];
                dashboardUserName.textContent = `Welcome back, ${firstName}!`;
            }
            
            // Update user avatar in dashboard
            const dashboardUserAvatar = document.getElementById('dashboardUserAvatar');
            if (dashboardUserAvatar) {
                const initials = auth.name.split(' ').map(n => n[0]).join('').toUpperCase();
                dashboardUserAvatar.textContent = initials;
            }
            
            // Update member role/since date
            const dashboardUserRole = document.getElementById('dashboardUserRole');
            if (dashboardUserRole) {
                const memberSince = getMemberJoinDate(auth.email);
                dashboardUserRole.textContent = `Member since ${memberSince}`;
            }

            // Update main welcome message
            const personalizedWelcome = document.getElementById('personalizedWelcome');
            if (personalizedWelcome) {
                const firstName = auth.name.split(' ')[0];
                const currentHour = new Date().getHours();
                let greeting = 'Good morning';
                if (currentHour >= 12 && currentHour < 18) greeting = 'Good afternoon';
                else if (currentHour >= 18) greeting = 'Good evening';
                
                personalizedWelcome.textContent = `${greeting}, ${firstName}! Here's what's happening in your network`;
            }
        }

        // Update dashboard statistics
        function updateDashboardStats(auth) {
            // Update connection count
            const memberConnectionCount = document.getElementById('memberConnectionCount');
            if (memberConnectionCount) {
                const connectionCount = calculateUserConnections(auth.email);
                memberConnectionCount.textContent = connectionCount;
            }
            
            // Update message count
            const memberMessageCount = document.getElementById('memberMessageCount');
            if (memberMessageCount) {
                const messageCount = calculateUserMessages(auth.email);
                memberMessageCount.textContent = messageCount;
            }
            
            // Update event count
            const memberEventCount = document.getElementById('memberEventCount');
            if (memberEventCount) {
                const eventCount = calculateUserEvents(auth.email);
                memberEventCount.textContent = eventCount;
            }
        }

        // Update daily insights with member-specific content
        function updateDailyInsights(auth) {
            const messageInsight = document.getElementById('messageInsight');
            if (messageInsight) {
                const profileViews = calculateProfileViews(auth.email);
                const insights = generatePersonalizedInsights(auth);
                messageInsight.innerHTML = insights.messageInsight;
            }

            // Update other insights based on member activity
            const insightsList = document.getElementById('insightsList');
            if (insightsList && insightsList.children.length >= 3) {
                const insights = generatePersonalizedInsights(auth);
                
                // Update first insight (matches)
                insightsList.children[0].querySelector('span:last-child').innerHTML = insights.matchInsight;
                
                // Update third insight (events)
                insightsList.children[2].querySelector('span:last-child').innerHTML = insights.eventInsight;
            }
        }

        // Generate personalized insights based on member data
        function generatePersonalizedInsights(auth) {
            const memberData = getMemberStoredData(auth.email);
            const profileCompletion = calculateActualProfileStrength(auth.email);
            const connectionCount = calculateUserConnections(auth.email);
            
            let matchInsight = 'Complete your profile to get more accurate matches';
            if (profileCompletion > 80) {
                matchInsight = `You have <strong style="color: #d4af37;">${Math.floor(Math.random() * 5) + 3} new potential matches</strong> based on your profile`;
            } else if (profileCompletion > 60) {
                matchInsight = `<strong style="color: #d4af37;">${Math.floor(Math.random() * 3) + 1} potential matches</strong> found - complete profile for more`;
            }

            const profileViews = Math.floor(Math.random() * 8) + 2;
            const messageInsight = `<strong style="color: #51cf66;">${profileViews} members</strong> viewed your profile this week`;

            const daysUntilEvent = 6;
            let eventInsight = `Next networking event is in <strong style="color: #fab005;">${daysUntilEvent} days</strong> - Register now!`;
            if (connectionCount > 10) {
                eventInsight = `You're well connected! <strong style="color: #fab005;">Bring a guest</strong> to the next event`;
            }

            return {
                matchInsight,
                messageInsight,
                eventInsight
            };
        }

        // Calculate actual profile strength based on filled fields
        function calculateActualProfileStrength(email) {
            const memberData = getMemberStoredData(email);
            const requiredFields = ['memberName', 'memberCompany', 'memberTitle', 'memberIndustry', 'memberLinkedIn'];
            const optionalFields = ['targetIndustry', 'targetSize', 'primaryOffering', 'valueProposition'];
            
            let completed = 0;
            let total = requiredFields.length + optionalFields.length;
            
            // Check required fields (weighted more heavily)
            requiredFields.forEach(field => {
                if (memberData && memberData[field] && memberData[field].trim()) {
                    completed += 1.5; // Required fields worth more
                }
            });
            
            // Check optional fields
            optionalFields.forEach(field => {
                if (memberData && memberData[field] && memberData[field].trim()) {
                    completed += 1;
                }
            });

            // Check if tags are selected
            const lookingForTags = document.querySelectorAll('.opportunity-tag.active');
            if (lookingForTags.length > 0) completed += 1;

            // Check company size selection
            const companySizeSelected = document.querySelector('input[name="company-size"]:checked');
            if (companySizeSelected) completed += 0.5;

            total += 1.5; // Add weight for tags and company size
            
            return Math.round((completed / total) * 100);
        }

        // Helper functions for calculating member stats
        function getMemberJoinDate(email) {
            const memberData = getMemberStoredData(email);
            if (memberData && memberData.joinDate) {
                return new Date(memberData.joinDate).getFullYear();
            }
            return new Date().getFullYear(); // Default to current year
        }

        function calculateUserConnections(email) {
            const connections = localStorage.getItem(`connections_${email}`);
            if (connections) {
                try {
                    const parsedConnections = JSON.parse(connections);
                    return Array.isArray(parsedConnections) ? parsedConnections.length : 0;
                } catch {
                    return 0;
                }
            }
            // Default based on member activity
            const memberData = getMemberStoredData(email);
            if (memberData && memberData.memberName) {
                return Math.floor(Math.random() * 10) + 5; // Simulate 5-15 connections
            }
            return 3;
        }

        function calculateUserMessages(email) {
            const chatHistory = localStorage.getItem('chatHistory');
            if (chatHistory) {
                try {
                    const history = JSON.parse(chatHistory);
                    let messageCount = 0;
                    Object.values(history).forEach(conversation => {
                        if (Array.isArray(conversation)) {
                            messageCount += conversation.filter(msg => msg.sender === 'user').length;
                        }
                    });
                    return messageCount;
                } catch {
                    return 0;
                }
            }
            return Math.floor(Math.random() * 15) + 3; // Simulate 3-18 messages
        }

        function calculateUserEvents(email) {
            const eventData = localStorage.getItem(`events_${email}`);
            if (eventData) {
                try {
                    const events = JSON.parse(eventData);
                    return Array.isArray(events) ? events.length : 0;
                } catch {
                    return 0;
                }
            }
            return Math.floor(Math.random() * 5) + 1; // Simulate 1-6 events
        }

        function calculateProfileViews(email) {
            const viewData = localStorage.getItem(`profile_views_${email}`);
            if (viewData) {
                try {
                    const views = JSON.parse(viewData);
                    return views.weekly || 0;
                } catch {
                    return 0;
                }
            }
            return Math.floor(Math.random() * 8) + 2; // Simulate 2-10 views
        }

        function getMemberStoredData(email) {
            try {
                const memberData = localStorage.getItem(`memberProfile_${email}`);
                return memberData ? JSON.parse(memberData) : {};
            } catch {
                return {};
            }
        }

        // Update the save profile function to be member-specific
        async function saveProfile() {
            // Validate form before saving
            if (!validator.validateAll()) {
                return; // Stop saving if validation fails
            }

            if (!currentMember) {
                alert('Session expired. Please log in again.');
                window.location.href = '/member-login';
                return;
            }

            try {
                const memberEmail = currentMember.email;

                // Get all form data
                const fullName = document.getElementById('memberName')?.value || '';
                const nameParts = fullName.trim().split(' ');
                const firstName = nameParts[0] || '';
                const lastName = nameParts.slice(1).join(' ') || '';

                const profileData = {
                    first_name: firstName,
                    last_name: lastName,
                    company_name: document.getElementById('memberCompany')?.value || '',
                    job_title: document.getElementById('memberTitle')?.value || '',
                    industry: document.getElementById('memberIndustry')?.value || '',
                    linkedin_url: document.getElementById('memberLinkedIn')?.value || ''
                };

                // Save to Supabase
                const { data, error } = await supabase
                    .from('members')
                    .update(profileData)
                    .eq('id', currentMember.id)
                    .select()
                    .single();

                if (error) {
                    console.error('Error saving profile:', error);
                    alert('Failed to save profile. Please try again.');
                    return;
                }

                // Update global currentMember
                currentMember = { ...currentMember, ...data };

                // Also save to localStorage for backwards compatibility
                const localProfileData = {
                    name: fullName,
                    company: profileData.company_name,
                    title: profileData.job_title,
                    industry: profileData.industry,
                    linkedin: profileData.linkedin_url,
                    lookingFor: Array.from(document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active')).map(tag => tag.textContent),
                    canOffer: Array.from(document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active')).map(tag => tag.textContent),
                    companySize: document.querySelector('input[name="company-size"]:checked')?.value || '',
                    lastUpdated: new Date().toISOString()
                };

                // Save to member-specific localStorage key
                const profileKey = `memberProfile_${memberEmail}`;
                localStorage.setItem(profileKey, JSON.stringify(profileData));
                
                alert(' Profile saved successfully! Your information has been updated.');
                
                // Update any displayed member info in other sections
                updateMemberInfoThroughoutPortal(profileData);
                
            } catch (error) {
                console.error('Error saving profile:', error);
                alert(' Error saving profile. Please try again.');
            }
        }

        function updateMemberInfoThroughoutPortal(profileData) {
            // Update header if name changed
            if (profileData.name) {
                const userNameElement = document.getElementById('userName');
                if (userNameElement) userNameElement.textContent = profileData.name;
                
                // Update avatar initials
                const userAvatarElement = document.getElementById('userAvatar');
                if (userAvatarElement && !userAvatarElement.style.backgroundImage) {
                    const initials = profileData.name.split(' ').map(n => n[0]).join('').toUpperCase();
                    userAvatarElement.textContent = initials;
                }
            }
            
            // Update profile progress after saving
            updateProfileProgress();
            
            // Show success message
            validator.showSuccessToast(' Profile saved successfully!');
        }

        // Form Validation System
        class FormValidator {
            constructor() {
                this.rules = {};
                this.errors = {};
                this.init();
            }

            init() {
                // Add event listeners for real-time validation
                document.querySelectorAll('input, select, textarea').forEach(field => {
                    field.addEventListener('blur', (e) => this.validateField(e.target));
                    field.addEventListener('input', (e) => {
                        if (this.errors[e.target.name]) {
                            this.validateField(e.target);
                        }
                    });
                });
            }

            addRule(fieldName, validator, message) {
                this.rules[fieldName] = { validator, message };
                return this;
            }

            validateField(field) {
                const rule = this.rules[field.name];
                if (!rule) return true;

                const isValid = rule.validator(field.value.trim());
                
                if (isValid) {
                    this.clearFieldError(field);
                    this.showFieldSuccess(field);
                    delete this.errors[field.name];
                } else {
                    this.showFieldError(field, rule.message);
                    this.errors[field.name] = rule.message;
                }

                return isValid;
            }

            validateAll() {
                let isFormValid = true;
                this.errors = {};

                Object.keys(this.rules).forEach(fieldName => {
                    const field = document.querySelector(`[name="${fieldName}"]`);
                    if (field) {
                        const isFieldValid = this.validateField(field);
                        if (!isFieldValid) {
                            isFormValid = false;
                        }
                    }
                });

                if (!isFormValid) {
                    this.showValidationSummary();
                    this.showErrorToast('Please fix the errors below before saving');
                } else {
                    this.hideValidationSummary();
                }

                return isFormValid;
            }

            showFieldError(field, message) {
                field.classList.add('form-field-error');
                field.classList.remove('form-field-success');

                // Remove existing error message
                const existingError = field.parentNode.querySelector('.field-error-message');
                if (existingError) {
                    existingError.remove();
                }

                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error-message show';
                errorDiv.textContent = message;
                field.parentNode.appendChild(errorDiv);
            }

            clearFieldError(field) {
                field.classList.remove('form-field-error');
                const errorMessage = field.parentNode.querySelector('.field-error-message');
                if (errorMessage) {
                    errorMessage.remove();
                }
            }

            showFieldSuccess(field) {
                if (field.value.trim() !== '') {
                    field.classList.add('form-field-success');
                    field.classList.remove('form-field-error');
                }
            }

            showValidationSummary() {
                let summaryElement = document.querySelector('.form-validation-summary');
                
                if (!summaryElement) {
                    summaryElement = document.createElement('div');
                    summaryElement.className = 'form-validation-summary';
                    const formSection = document.querySelector('#profile .dashboard-grid');
                    if (formSection) {
                        formSection.parentNode.insertBefore(summaryElement, formSection);
                    }
                }

                const errorList = Object.values(this.errors).map(error => `<li>${error}</li>`).join('');
                summaryElement.innerHTML = `
                    <h4> Please fix these issues:</h4>
                    <ul>${errorList}</ul>
                `;
                summaryElement.classList.add('show');
                summaryElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            hideValidationSummary() {
                const summaryElement = document.querySelector('.form-validation-summary');
                if (summaryElement) {
                    summaryElement.classList.remove('show');
                }
            }

            showErrorToast(message) {
                this.showToast(message, 'error');
            }

            showSuccessToast(message) {
                this.showToast(message, 'success');
            }

            showToast(message, type) {
                // Remove existing toast
                const existingToast = document.querySelector('.error-toast, .success-toast');
                if (existingToast) {
                    existingToast.remove();
                }

                const toast = document.createElement('div');
                toast.className = `${type}-toast`;
                toast.textContent = message;
                document.body.appendChild(toast);

                // Show toast
                setTimeout(() => toast.classList.add('show'), 100);

                // Hide toast after 4 seconds
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }, 4000);
            }
        }

        // Initialize form validation
        const validator = new FormValidator();

        // Add validation rules
        validator
            .addRule('memberName', value => value.length >= 2, 'Name must be at least 2 characters long')
            .addRule('memberCompany', value => value.length >= 2, 'Company name must be at least 2 characters long')
            .addRule('memberTitle', value => value.length >= 2, 'Job title must be at least 2 characters long')
            .addRule('memberIndustry', value => value !== '', 'Please select your industry')
            .addRule('memberLinkedIn', value => {
                if (value === '') return true; // Optional field
                return value.includes('linkedin.com') || value.includes('in/');
            }, 'Please enter a valid LinkedIn URL')
            .addRule('primaryOffering', value => {
                if (value === '') return true; // Optional field
                return value.length >= 10;
            }, 'Primary offering should be at least 10 characters')
            .addRule('valueProposition', value => {
                if (value === '') return true; // Optional field
                return value.length >= 10;
            }, 'Value proposition should be at least 10 characters');

        // Profile Progress Functions
        function updateProfileProgress() {
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;

            try {
                const auth = JSON.parse(memberAuth);
                const memberEmail = auth.email;
                
                let completedItems = 0;
                const totalItems = 4;
                
                // Check basic information
                const hasBasicInfo = checkBasicInformation();
                updateProgressItem('tipBasicInfo', 'statusBasicInfo', hasBasicInfo);
                if (hasBasicInfo) completedItems++;
                
                // Check profile photo
                const hasPhoto = localStorage.getItem(`memberPersonalPhoto_${memberEmail}`) !== null;
                updateProgressItem('tipPhoto', 'statusPhoto', hasPhoto);
                if (hasPhoto) completedItems++;
                
                // Check business preferences
                const hasBusinessInfo = checkBusinessPreferences();
                updateProgressItem('tipBusinessInfo', 'statusBusinessInfo', hasBusinessInfo);
                if (hasBusinessInfo) completedItems++;
                
                // Check LinkedIn
                const hasLinkedIn = document.getElementById('memberLinkedIn')?.value.trim().length > 0;
                updateProgressItem('tipLinkedIn', 'statusLinkedIn', hasLinkedIn);
                if (hasLinkedIn) completedItems++;
                
                // Update progress bar and percentage
                const percentage = Math.round((completedItems / totalItems) * 100);
                document.getElementById('profileCompletionPercentage').textContent = percentage + '%';
                document.getElementById('profileProgressFill').style.width = percentage + '%';
                
                // Update action button text
                const actionText = document.getElementById('progressActionText');
                if (percentage === 100) {
                    actionText.textContent = ' Profile Complete!';
                } else if (percentage >= 75) {
                    actionText.textContent = 'Almost Done! Add Final Details';
                } else if (percentage >= 50) {
                    actionText.textContent = 'You\'re Halfway There!';
                } else {
                    actionText.textContent = 'Complete Your Profile';
                }
                
            } catch (error) {
                console.error('Error updating profile progress:', error);
            }
        }

        function checkBasicInformation() {
            const name = document.getElementById('memberName')?.value.trim();
            const company = document.getElementById('memberCompany')?.value.trim();
            const title = document.getElementById('memberTitle')?.value.trim();
            const industry = document.getElementById('memberIndustry')?.value;
            
            return name && company && title && industry;
        }

        function checkBusinessPreferences() {
            const lookingForTags = document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active');
            const canOfferTags = document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active');
            const companySize = document.querySelector('input[name="company-size"]:checked');
            
            return lookingForTags.length > 0 && canOfferTags.length > 0 && companySize;
        }

        function updateProgressItem(tipId, statusId, isCompleted) {
            const tipItem = document.getElementById(tipId);
            const statusElement = document.getElementById(statusId);
            
            if (isCompleted) {
                tipItem.classList.add('completed');
                statusElement.textContent = '';
                statusElement.style.color = '#51cf66';
            } else {
                tipItem.classList.remove('completed');
                statusElement.textContent = '';
                statusElement.style.color = '#999';
            }
        }

        function focusIncompleteSection() {
            // Find first incomplete section and scroll to it
            const memberAuth = sessionStorage.getItem('memberAuth');
            if (!memberAuth) return;

            const auth = JSON.parse(memberAuth);
            const memberEmail = auth.email;

            if (!checkBasicInformation()) {
                document.getElementById('memberName').focus();
                return;
            }
            
            if (!localStorage.getItem(`memberPersonalPhoto_${memberEmail}`)) {
                document.getElementById('personalPhotoUpload').click();
                return;
            }
            
            if (!checkBusinessPreferences()) {
                document.querySelector('.opportunity-tag').scrollIntoView({ behavior: 'smooth' });
                return;
            }
            
            if (!document.getElementById('memberLinkedIn')?.value.trim()) {
                document.getElementById('memberLinkedIn').focus();
                return;
            }
            
            // If all complete, show success message
            alert(' Congratulations! Your profile is 100% complete. You\'re ready to make great connections!');
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('memberProfileModal');
            if (e.target === modal) {
                closeMemberProfile();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMemberProfile();
            }
        });

        // Chat System Functionality
        let currentChatMember = null;
        let chatHistory = {};

        function initializeChatSystem() {
            // Load chat history from localStorage
            const savedChats = localStorage.getItem('memberChats');
            if (savedChats) {
                chatHistory = JSON.parse(savedChats);
            }

            // Setup chat event listeners
            const chatInput = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendMessageBtn');

            if (chatInput && sendBtn) {
                sendBtn.addEventListener('click', sendMessage);
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }

            loadConversationList();
        }

        function loadConversationList() {
            const conversationsList = document.getElementById('conversationsList');
            if (!conversationsList) return;

            const members = [
                { id: 'april', name: 'April Sabral', company: 'Ask April AI Coaching', lastMessage: 'Welcome to the portal! Ready to connect.', time: '1 hour ago', unread: 1 },
                { id: 'joy', name: 'Joy Sabral', company: 'Owner Retail', lastMessage: 'Excited to be part of MBC!', time: '2 hours ago', unread: 0 }
            ];

            const conversationsHtml = members.map(member => `
                <div class="conversation-item ${member.unread > 0 ? 'unread' : ''}" onclick="openChat('${member.id}', '${member.name}', '${member.company}')">
                    <div class="conversation-avatar">${member.name.split(' ').map(n => n[0]).join('')}</div>
                    <div class="conversation-details">
                        <div class="conversation-header">
                            <span class="conversation-name">${member.name}</span>
                            <span class="conversation-time">${member.time}</span>
                        </div>
                        <div class="conversation-preview">
                            ${member.lastMessage}
                        </div>
                    </div>
                    ${member.unread > 0 ? `<div class="unread-badge">${member.unread}</div>` : ''}
                </div>
            `).join('');

            conversationsList.innerHTML = conversationsHtml;
        }

        function openChat(memberId, memberName, memberCompany) {
            currentChatMember = { id: memberId, name: memberName, company: memberCompany };
            
            // Update chat header
            const chatHeader = document.getElementById('chatHeader');
            if (chatHeader) {
                chatHeader.innerHTML = `
                    <div class="chat-member-info">
                        <div class="chat-avatar">${memberName.split(' ').map(n => n[0]).join('')}</div>
                        <div>
                            <div class="chat-member-name">${memberName}</div>
                            <div class="chat-member-company">${memberCompany}</div>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button class="chat-action-btn" onclick="scheduleCall('${memberId}')"></button>
                        <button class="chat-action-btn" onclick="viewMemberProfile('${memberId}')"></button>
                    </div>
                `;
            }

            // Load conversation history
            loadConversationHistory(memberId);

            // Show chat area, hide placeholder
            const chatPlaceholder = document.getElementById('chatPlaceholder');
            const chatArea = document.getElementById('chatArea');
            
            if (chatPlaceholder) chatPlaceholder.style.display = 'none';
            if (chatArea) chatArea.style.display = 'flex';

            // Mark conversation as read
            markConversationAsRead(memberId);
        }

        function loadConversationHistory(memberId) {
            const messagesContainer = document.getElementById('messagesContainer');
            if (!messagesContainer) return;

            const messages = chatHistory[memberId] || [];
            
            if (messages.length === 0) {
                // Add welcome message for new conversations
                messages.push({
                    id: Date.now(),
                    text: "Hi! Great to connect with you through Miami Business Council. Looking forward to our conversation!",
                    sender: memberId,
                    timestamp: new Date().toISOString(),
                    isOwn: false
                });
                chatHistory[memberId] = messages;
                saveChatHistory();
            }

            const messagesHtml = messages.map(message => `
                <div class="message ${message.isOwn ? 'own' : ''}">
                    <div class="message-avatar">${message.isOwn ? 'ME' : currentChatMember.name.split(' ').map(n => n[0]).join('')}</div>
                    <div class="message-content">
                        <div class="message-text">${message.text}</div>
                        <div class="message-time">${formatMessageTime(message.timestamp)}</div>
                    </div>
                </div>
            `).join('');

            messagesContainer.innerHTML = messagesHtml;
            scrollToBottom();
        }

        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            if (!chatInput || !currentChatMember) return;

            const messageText = chatInput.value.trim();
            if (!messageText) return;

            const message = {
                id: Date.now(),
                text: messageText,
                sender: 'me',
                timestamp: new Date().toISOString(),
                isOwn: true
            };

            // Add to chat history
            if (!chatHistory[currentChatMember.id]) {
                chatHistory[currentChatMember.id] = [];
            }
            chatHistory[currentChatMember.id].push(message);

            // Clear input
            chatInput.value = '';

            // Reload conversation
            loadConversationHistory(currentChatMember.id);

            // Save chat history
            saveChatHistory();

            // Simulate response after a delay
            setTimeout(() => simulateResponse(), 1000 + Math.random() * 2000);
        }

        function simulateResponse() {
            if (!currentChatMember) return;

            const responses = [
                "Thanks for reaching out! I'd love to learn more about your business.",
                "That sounds like a great opportunity. When would be a good time to discuss this further?",
                "I appreciate you thinking of me for this project. Let me review and get back to you.",
                "Absolutely! I think there could be some great synergies between our businesses.",
                "That's an interesting perspective. I'd like to explore this idea more.",
                "Great to hear from you! Let's schedule a call to discuss this in detail."
            ];

            const response = {
                id: Date.now(),
                text: responses[Math.floor(Math.random() * responses.length)],
                sender: currentChatMember.id,
                timestamp: new Date().toISOString(),
                isOwn: false
            };

            chatHistory[currentChatMember.id].push(response);
            loadConversationHistory(currentChatMember.id);
            saveChatHistory();

            // Update conversation list to show new message
            loadConversationList();
        }

        function markConversationAsRead(memberId) {
            // Remove unread styling
            const conversationItem = document.querySelector(`[onclick*="${memberId}"]`);
            if (conversationItem) {
                conversationItem.classList.remove('unread');
                const unreadBadge = conversationItem.querySelector('.unread-badge');
                if (unreadBadge) {
                    unreadBadge.style.display = 'none';
                }
            }
        }

        function scrollToBottom() {
            const messagesContainer = document.getElementById('messagesContainer');
            if (messagesContainer) {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
        }

        function formatMessageTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffInMinutes = Math.floor((now - date) / (1000 * 60));

            if (diffInMinutes < 1) return 'now';
            if (diffInMinutes < 60) return `${diffInMinutes}m ago`;
            if (diffInMinutes < 24 * 60) return `${Math.floor(diffInMinutes / 60)}h ago`;
            return date.toLocaleDateString();
        }

        function saveChatHistory() {
            localStorage.setItem('memberChats', JSON.stringify(chatHistory));
        }

        function scheduleCall(memberId) {
            alert(`Call scheduling with ${currentChatMember.name} - This feature will integrate with calendar systems soon!`);
        }

        function viewMemberProfile(memberId) {
            alert(`Viewing full profile for ${currentChatMember.name} - This will open their complete business profile.`);
        }

        // Start chat from member directory
        function startChatFromDirectory(memberId, memberName, memberCompany) {
            showSection('messages');
            // Open the chat with this member
            openChat(memberId, memberName, memberCompany);
        }

        // Member Directory Search Functionality
        function filterMembers() {
            const searchInput = document.getElementById('memberSearchInput');
            const clearBtn = document.getElementById('clearSearchBtn');
            const memberCards = document.querySelectorAll('.member-card');
            const memberGrid = document.querySelector('.member-grid');
            
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            // Show/hide clear button
            if (searchTerm.length > 0) {
                clearBtn.style.display = 'flex';
            } else {
                clearBtn.style.display = 'none';
            }
            
            let visibleCount = 0;
            
            memberCards.forEach(card => {
                const name = card.querySelector('h3')?.textContent.toLowerCase() || '';
                const company = card.querySelector('.member-info p:last-child')?.textContent.toLowerCase() || '';
                const title = card.querySelector('.member-info p:first-child')?.textContent.toLowerCase() || '';
                const tags = Array.from(card.querySelectorAll('.member-tag')).map(tag => tag.textContent.toLowerCase()).join(' ');
                
                const searchableText = `${name} ${company} ${title} ${tags}`;
                
                if (searchTerm === '' || searchableText.includes(searchTerm)) {
                    card.classList.remove('hidden');
                    visibleCount++;
                } else {
                    card.classList.add('hidden');
                }
            });
            
            // Remove existing no-results message
            const existingNoResults = memberGrid.querySelector('.no-results');
            if (existingNoResults) {
                existingNoResults.remove();
            }
            
            // Show no results message if needed
            if (visibleCount === 0 && searchTerm.length > 0) {
                const noResultsDiv = document.createElement('div');
                noResultsDiv.className = 'no-results';
                noResultsDiv.innerHTML = `
                    <h3> No members found</h3>
                    <p>No members match your search for "<strong>${searchInput.value}</strong>"</p>
                    <p>Try searching by name, company, or industry.</p>
                    <button class="register-btn" onclick="clearMemberSearch()" style="margin-top: 1rem;">Clear Search</button>
                `;
                memberGrid.appendChild(noResultsDiv);
            }
            
            // Update search results count
            updateSearchResultsCount(visibleCount, searchTerm);
        }

        function clearMemberSearch() {
            const searchInput = document.getElementById('memberSearchInput');
            const clearBtn = document.getElementById('clearSearchBtn');
            const memberCards = document.querySelectorAll('.member-card');
            const memberGrid = document.querySelector('.member-grid');
            
            searchInput.value = '';
            clearBtn.style.display = 'none';
            
            // Show all member cards
            memberCards.forEach(card => {
                card.classList.remove('hidden');
            });
            
            // Remove no-results message
            const noResultsDiv = memberGrid.querySelector('.no-results');
            if (noResultsDiv) {
                noResultsDiv.remove();
            }
            
            // Clear search results count
            updateSearchResultsCount(memberCards.length, '');
            
            // Focus back on search input
            searchInput.focus();
        }

        function updateSearchResultsCount(count, searchTerm) {
            const sectionHeader = document.querySelector('#directory .section-header p');
            if (!sectionHeader) return;
            
            if (searchTerm && searchTerm.length > 0) {
                sectionHeader.textContent = `Found ${count} member${count !== 1 ? 's' : ''} matching "${searchTerm}"`;
            } else {
                sectionHeader.textContent = 'Connect with fellow Miami business leaders';
            }
        }

        // Privacy Settings Functionality
        function initializePrivacySettings() {
            // Load saved privacy settings
            const savedSettings = localStorage.getItem('memberPrivacySettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // Apply saved settings
                Object.keys(settings).forEach(key => {
                    const checkbox = document.getElementById(key);
                    if (checkbox) {
                        checkbox.checked = settings[key];
                    }
                });
            }
            
            // Add change listeners to privacy toggles
            const privacyToggles = document.querySelectorAll('.privacy-toggle');
            privacyToggles.forEach(toggle => {
                toggle.addEventListener('change', savePrivacySettings);
            });
        }

        function savePrivacySettings() {
            const settings = {};
            const privacyToggles = document.querySelectorAll('.privacy-toggle');
            
            privacyToggles.forEach(toggle => {
                settings[toggle.id] = toggle.checked;
            });
            
            localStorage.setItem('memberPrivacySettings', JSON.stringify(settings));
            
            // Show brief confirmation
            const confirmationDiv = document.createElement('div');
            confirmationDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(40, 167, 69, 0.9);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            confirmationDiv.innerHTML = ' Privacy settings saved';
            document.body.appendChild(confirmationDiv);
            
            setTimeout(() => {
                confirmationDiv.remove();
            }, 2000);
        }

        // MBC Email Functionality
        function sendMBCEmail(memberEmail, memberName, memberCompany) {
            // Get current user info from session
            const memberAuth = JSON.parse(sessionStorage.getItem('memberAuth') || '{}');
            const currentUserName = memberAuth.name || 'MBC Member';
            
            // Check if recipient allows member emails (simulate check - in real app this would be from database)
            const allowsEmails = true; // This would come from their privacy settings
            
            if (!allowsEmails) {
                alert(`${memberName} has disabled direct member emails. Try connecting through LinkedIn or the chat system instead.`);
                return;
            }
            
            // Get current date
            const currentDate = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Create professional email template with MBC verification
            const subject = encodeURIComponent(`Miami Business Council Member Connection Request from ${currentUserName}`);
            
            const emailBody = encodeURIComponent(`Dear ${memberName},

I hope this email finds you well. I am reaching out to you as a fellow member of the Miami Business Council.

MEMBER VERIFICATION:
 This email is from a verified Miami Business Council member
 Member Name: ${currentUserName}
 Sent via MBC Member Portal on ${currentDate}
 For verification, please visit: https://miamibusinesscouncil.com/member-portal

INTRODUCTION:
I came across your profile in our member directory and was impressed by your work at ${memberCompany}. I believe there may be opportunities for collaboration or mutual benefit between our businesses.

NEXT STEPS:
I would love to schedule a brief call or coffee meeting to discuss potential synergies. Please let me know if you're interested and available for a conversation.

Best regards,

${currentUserName}
Miami Business Council Member

---
 This email was generated through the Miami Business Council Member Portal
 Your email preferences can be managed at: https://miamibusinesscouncil.com/member-portal
 Miami Business Council - Connecting Miami's Business Leaders
https://miamibusinesscouncil.com`);
            
            // Create mailto link
            const mailtoLink = `mailto:${memberEmail}?subject=${subject}&body=${emailBody}`;
            
            // Show confirmation dialog
            const confirmMessage = `Send professional MBC member introduction email to ${memberName} at ${memberCompany}?\n\nThe email will include:\n MBC member verification\n Professional introduction template\n Your contact information\n Meeting request`;
            
            if (confirm(confirmMessage)) {
                // Open email client
                window.location.href = mailtoLink;
                
                // Log the interaction (in real app, this would save to database)
                logEmailInteraction(memberEmail, memberName, memberCompany);
                
                // Show success message
                setTimeout(() => {
                    const successDiv = document.createElement('div');
                    successDiv.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: rgba(40, 167, 69, 0.9);
                        color: white;
                        padding: 1rem 1.5rem;
                        border-radius: 8px;
                        z-index: 1000;
                        max-width: 300px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    `;
                    successDiv.innerHTML = `
                        <div style="font-weight: 600; margin-bottom: 0.5rem;"> Email Opened</div>
                        <div style="font-size: 0.9rem;">Professional MBC introduction email created for ${memberName}</div>
                    `;
                    document.body.appendChild(successDiv);
                    
                    setTimeout(() => {
                        successDiv.remove();
                    }, 5000);
                }, 1000);
            }
        }

        function logEmailInteraction(memberEmail, memberName, memberCompany) {
            // Save email interaction to localStorage for analytics
            const interactions = JSON.parse(localStorage.getItem('emailInteractions') || '[]');
            
            interactions.push({
                recipientEmail: memberEmail,
                recipientName: memberName,
                recipientCompany: memberCompany,
                timestamp: new Date().toISOString(),
                type: 'mbc_introduction_email'
            });
            
            // Keep only last 50 interactions
            if (interactions.length > 50) {
                interactions.splice(0, interactions.length - 50);
            }
            
            localStorage.setItem('emailInteractions', JSON.stringify(interactions));
        }

        // Enhanced Smart Match Email Integration
        function sendSmartIntro(memberId, memberName) {
            // Get member data for smart intro
            const members = [
                { id: 'april', email: 'april@retailu.ca', company: 'Ask April AI Coaching' },
                { id: 'joy', email: 'sabral@me.com', company: 'Owner Retail' }
            ];
            
            const member = members.find(m => m.id === memberId);
            if (member) {
                sendMBCEmail(member.email, memberName, member.company);
            }
        }

        // Referral System Functionality
        function copyReferralLink() {
            const linkInput = document.getElementById('referralLinkInput');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(linkInput.value);
            
            const copyBtn = document.querySelector('.copy-link-btn');
            const originalText = copyBtn.textContent;
            copyBtn.textContent = ' Copied!';
            copyBtn.style.background = '#51cf66';
            
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.style.background = '#d4af37';
            }, 2000);
        }

        function shareViaEmail() {
            const memberAuth = JSON.parse(sessionStorage.getItem('memberAuth') || '{}');
            const currentUserName = memberAuth.name || 'MBC Member';
            const referralLink = document.getElementById('referralLinkInput').value;
            
            const subject = encodeURIComponent(`Join Miami Business Council - Invitation from ${currentUserName}`);
            const body = encodeURIComponent(`Hi there!

I wanted to personally invite you to join the Miami Business Council, Miami's premier networking organization for business leaders.

As a current member, I can tell you that MBC has been instrumental in growing my network and business opportunities. Here's what makes it special:

 AI-powered smart matching with ideal business partners
 Direct member-to-member communication platform  
 Monthly networking events with high-quality attendees
 Exclusive member directory and collaboration opportunities
 Professional development and speaking opportunities

JOIN HERE: ${referralLink}

When you join through my referral link, you'll get:
 Priority access to upcoming events
 Direct introduction to relevant members
 Access to our exclusive member portal

I'd be happy to introduce you to other members who align with your business goals once you join.

Best regards,
${currentUserName}
Miami Business Council Member

P.S. - The member portal has some amazing features including smart matching and direct messaging that have really helped me connect with the right people.`);
            
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
            updateInviteStats();
        }

        function shareOnLinkedIn() {
            const memberAuth = JSON.parse(sessionStorage.getItem('memberAuth') || '{}');
            const currentUserName = memberAuth.name || 'MBC Member';
            const referralLink = document.getElementById('referralLinkInput').value;
            
            const text = encodeURIComponent(`I'm excited to be part of Miami Business Council, where AI-powered networking meets real business growth! 

If you're a Miami business leader looking to:
 Connect with ideal clients & partners through smart matching
 Access exclusive networking events
 Join a curated community of entrepreneurs

You should check this out: ${referralLink}

The member portal is incredibly well-designed with features like direct messaging and intelligent business matching. It's like LinkedIn but specifically for Miami's business community.

#MiamiBusinessCouncil #Networking #BusinessGrowth #Miami #Entrepreneurship`);
            
            const linkedInUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(referralLink)}&text=${text}`;
            window.open(linkedInUrl, '_blank');
            updateInviteStats();
        }

        function shareViaSMS() {
            const memberAuth = JSON.parse(sessionStorage.getItem('memberAuth') || '{}');
            const currentUserName = memberAuth.name || 'MBC Member';
            const referralLink = document.getElementById('referralLinkInput').value;
            
            const message = encodeURIComponent(`Hey! I'm a member of Miami Business Council and thought you'd be interested. It's an exclusive networking org for Miami business leaders with AI-powered matching and great events. Check it out: ${referralLink} - ${currentUserName}`);
            
            window.location.href = `sms:?body=${message}`;
            updateInviteStats();
        }

        function shareGeneric() {
            const referralLink = document.getElementById('referralLinkInput').value;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Join Miami Business Council',
                    text: 'Join Miami\'s premier business networking organization with AI-powered matching and exclusive events.',
                    url: referralLink
                });
            } else {
                copyReferralLink();
                alert('Referral link copied to clipboard! Share it with potential members.');
            }
            updateInviteStats();
        }

        function updateInviteStats() {
            // Update invite count
            const totalInvites = parseInt(document.getElementById('totalInvites').textContent) + 1;
            document.getElementById('totalInvites').textContent = totalInvites;
            
            // Save to localStorage
            const stats = JSON.parse(localStorage.getItem('referralStats') || '{"totalInvites": 0, "successfulReferrals": 3}');
            stats.totalInvites = totalInvites;
            localStorage.setItem('referralStats', JSON.stringify(stats));
            
            // Update conversion rate
            const conversionRate = Math.round((stats.successfulReferrals / totalInvites) * 100);
            document.getElementById('conversionRate').textContent = conversionRate + '%';
        }

        function claimReward(rewardType) {
            const currentPoints = parseInt(document.getElementById('memberPoints').textContent);
            let cost, rewardName, message;
            
            switch(rewardType) {
                case 'speaking':
                    cost = 500;
                    rewardName = 'Speaking Opportunity';
                    message = 'Speaking slot reserved! We\'ll contact you about upcoming event opportunities.';
                    break;
                case 'affiliate':
                    cost = 300;
                    rewardName = 'Affiliate Commission';
                    message = 'Affiliate program activated! You\'ll now earn 20% commission on successful referrals.';
                    break;
                default:
                    return;
            }
            
            if (currentPoints >= cost) {
                if (confirm(`Claim ${rewardName} for ${cost} points?\n\nThis will deduct ${cost} points from your account.`)) {
                    // Deduct points
                    const newPoints = currentPoints - cost;
                    document.getElementById('memberPoints').textContent = newPoints + ' pts';
                    
                    // Save to localStorage
                    localStorage.setItem('memberPoints', newPoints);
                    
                    // Show success message
                    alert(` ${rewardName} claimed successfully!\n\n${message}\n\nRemaining points: ${newPoints}`);
                    
                    // Update reward card to claimed state
                    const rewardCard = event.target.closest('.reward-card');
                    const claimBtn = rewardCard.querySelector('.claim-reward-btn');
                    claimBtn.textContent = 'Claimed ';
                    claimBtn.disabled = true;
                    claimBtn.style.background = '#51cf66';
                    claimBtn.style.color = '#000';
                }
            } else {
                alert(`Not enough points! You need ${cost} points but only have ${currentPoints} points.\n\nEarn more points by referring new members (100 points each).`);
            }
        }

        function initializeReferralSystem() {
            // Load saved stats
            const stats = JSON.parse(localStorage.getItem('referralStats') || '{"totalInvites": 12, "successfulReferrals": 3}');
            document.getElementById('totalInvites').textContent = stats.totalInvites;
            document.getElementById('successfulReferrals').textContent = stats.successfulReferrals;
            
            const conversionRate = Math.round((stats.successfulReferrals / stats.totalInvites) * 100);
            document.getElementById('conversionRate').textContent = conversionRate + '%';
            
            // Load saved points
            const points = localStorage.getItem('memberPoints') || '250';
            document.getElementById('memberPoints').textContent = points + ' pts';
            
            // Generate unique referral code based on member info
            const memberAuth = JSON.parse(sessionStorage.getItem('memberAuth') || '{}');
            if (memberAuth.name) {
                const initials = memberAuth.name.split(' ').map(n => n[0]).join('');
                const year = new Date().getFullYear();
                const referralCode = `${initials}${year}`;
                document.getElementById('referralLinkInput').value = `https://miamibusinesscouncil.com/join?ref=${referralCode}`;
            }
        }

        // PWA Functionality
        let deferredPrompt;
        let isIOS = false;
        let isInStandaloneMode = false;

        // Check if device is iOS
        function checkIOS() {
            return /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                   (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        }

        // Check if app is in standalone mode
        function checkStandaloneMode() {
            return window.matchMedia('(display-mode: standalone)').matches ||
                   window.navigator.standalone ||
                   document.referrer.includes('android-app://');
        }

        // Register Service Worker
        async function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('[PWA] Service Worker registered:', registration);
                    
                    // Listen for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New version available
                                showUpdateAvailable();
                            }
                        });
                    });
                    
                    return registration;
                } catch (error) {
                    console.error('[PWA] Service Worker registration failed:', error);
                }
            }
        }

        // Show PWA install prompt
        function showInstallPrompt() {
            const banner = document.getElementById('pwaInstallBanner');
            const installBtn = document.getElementById('pwaInstallBtn');
            const dismissBtn = document.getElementById('pwaDismissBtn');
            const closeBtn = document.getElementById('pwaCloseBtn');
            
            // Don't show if already dismissed or installed
            if (localStorage.getItem('pwaInstallDismissed') || isInStandaloneMode) {
                return;
            }

            // Show banner
            banner.style.display = 'block';
            
            // Handle install button
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log('[PWA] Install prompt outcome:', outcome);
                    
                    if (outcome === 'accepted') {
                        localStorage.setItem('pwaInstalled', 'true');
                    }
                    deferredPrompt = null;
                } else if (isIOS) {
                    // Show iOS install instructions
                    showIOSInstallInstructions();
                }
                banner.style.display = 'none';
            });
            
            // Handle dismiss button
            dismissBtn.addEventListener('click', () => {
                banner.style.display = 'none';
                localStorage.setItem('pwaInstallDismissed', Date.now());
            });

            // Handle close button (X)
            closeBtn.addEventListener('click', () => {
                banner.style.display = 'none';
                localStorage.setItem('pwaInstallDismissed', Date.now());
            });
        }

        // Show iOS install instructions
        function showIOSInstallInstructions() {
            const message = `To install MBC Portal on your iPhone:

1. Tap the Share button (square with arrow up)
2. Scroll down and tap "Add to Home Screen"
3. Tap "Add" to install the app

You'll then have quick access to chat with members and manage your business connections!`;
            
            alert(message);
        }

        // Show update available notification
        function showUpdateAvailable() {
            const updateDiv = document.createElement('div');
            updateDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #d4af37;
                color: #000;
                padding: 1rem;
                border-radius: 8px;
                z-index: 1000;
                max-width: 300px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            `;
            updateDiv.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 0.5rem;"> Update Available</div>
                <div style="font-size: 0.9rem; margin-bottom: 1rem;">A new version of MBC Portal is available with improvements and new features.</div>
                <button onclick="location.reload()" style="background: #000; color: #d4af37; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; margin-right: 0.5rem;">Update Now</button>
                <button onclick="this.parentElement.remove()" style="background: rgba(0,0,0,0.1); border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">Later</button>
            `;
            document.body.appendChild(updateDiv);
            
            setTimeout(() => {
                if (updateDiv.parentElement) {
                    updateDiv.remove();
                }
            }, 10000);
        }

        // Request notification permission
        async function requestNotificationPermission() {
            if ('Notification' in window && 'serviceWorker' in navigator) {
                const permission = await Notification.requestPermission();
                console.log('[PWA] Notification permission:', permission);
                
                if (permission === 'granted') {
                    // Subscribe to push notifications
                    subscribeToNotifications();
                }
                
                return permission;
            }
            return 'not-supported';
        }

        // Subscribe to push notifications
        async function subscribeToNotifications() {
            try {
                const registration = await navigator.serviceWorker.ready;
                const subscription = await registration.pushManager.subscribe({
                    userVisibleOnly: true,
                    applicationServerKey: null // Would use actual VAPID key in production
                });
                console.log('[PWA] Push subscription:', subscription);
                
                // Send subscription to server (would implement in production)
                // await sendSubscriptionToServer(subscription);
            } catch (error) {
                console.error('[PWA] Push subscription failed:', error);
            }
        }

        // Mobile navigation toggle
        function initializeMobileNavigation() {
            // Create mobile menu toggle button
            const header = document.querySelector('.portal-header');
            const sidebar = document.querySelector('.sidebar');
            
            // Add mobile menu button to header on mobile
            if (window.innerWidth <= 768) {
                const mobileMenuBtn = document.createElement('button');
                mobileMenuBtn.innerHTML = '';
                mobileMenuBtn.style.cssText = `
                    background: none;
                    border: none;
                    color: #d4af37;
                    font-size: 1.5rem;
                    cursor: pointer;
                    display: block;
                `;
                
                mobileMenuBtn.addEventListener('click', () => {
                    sidebar.classList.toggle('mobile-open');
                });
                
                // Insert at beginning of header content
                const headerContent = document.querySelector('.header-content');
                headerContent.insertBefore(mobileMenuBtn, headerContent.firstChild);
                
                // Close menu when clicking nav items
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        sidebar.classList.remove('mobile-open');
                    });
                });
            }
        }

        // Enhanced chat for mobile
        function initializeMobileChat() {
            const chatSidebar = document.querySelector('.chat-sidebar');
            const chatMain = document.querySelector('.chat-main');
            
            if (window.innerWidth <= 768 && chatSidebar && chatMain) {
                // Add back button to chat header
                const chatHeader = document.getElementById('chatHeader');
                if (chatHeader) {
                    const backBtn = document.createElement('button');
                    backBtn.innerHTML = ' Back';
                    backBtn.style.cssText = `
                        background: rgba(255,255,255,0.1);
                        border: none;
                        color: #e8eaed;
                        padding: 0.5rem;
                        border-radius: 4px;
                        cursor: pointer;
                        margin-right: 1rem;
                    `;
                    
                    backBtn.addEventListener('click', () => {
                        chatSidebar.classList.add('mobile-open');
                        document.getElementById('chatArea').style.display = 'none';
                        document.getElementById('chatPlaceholder').style.display = 'flex';
                    });
                }
            }
        }

        // Initialize PWA features
        function initializePWA() {
            isIOS = checkIOS();
            isInStandaloneMode = checkStandaloneMode();
            
            console.log('[PWA] iOS:', isIOS, 'Standalone:', isInStandaloneMode);
            
            // Register service worker
            registerServiceWorker();
            
            // Listen for install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                console.log('[PWA] Install prompt available');
                e.preventDefault();
                deferredPrompt = e;
                
                // Show custom install prompt after delay
                setTimeout(() => {
                    showInstallPrompt();
                }, 3000);
            });
            
            // Handle app installed
            window.addEventListener('appinstalled', () => {
                console.log('[PWA] App installed successfully');
                localStorage.setItem('pwaInstalled', 'true');
                
                // Hide install banner if showing
                const banner = document.getElementById('pwaInstallBanner');
                if (banner) banner.style.display = 'none';
                
                // Request notification permission after install
                setTimeout(() => {
                    requestNotificationPermission();
                }, 2000);
            });
            
            // Show install prompt for iOS or other browsers after delay
            if (!isInStandaloneMode && !localStorage.getItem('pwaInstallDismissed')) {
                setTimeout(() => {
                    showInstallPrompt();
                }, 5000);
            }
            
            // Initialize mobile features
            initializeMobileNavigation();
            initializeMobileChat();
        }

        // Portal Preview and Screenshot Functionality
        function generatePortalPreview() {
            // Create a preview modal showing the portal in action
            const previewModal = document.createElement('div');
            previewModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.9);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                backdrop-filter: blur(10px);
            `;
            
            previewModal.innerHTML = `
                <div style="background: rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; max-width: 90vw; max-height: 90vh; overflow: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="color: #d4af37; margin: 0;"> Portal Preview Gallery</h2>
                        <button onclick="this.closest('div').parentElement.remove()" style="background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;"></button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <!-- Dashboard Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Dashboard</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>Member Dashboard</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Events  Stats  Quick Actions</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Smart Matches Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Smart Matches</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>AI-Powered Matching</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Find Ideal Clients  Partners</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Messages</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>Direct Member Chat</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Real-time Messaging</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Directory Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Directory</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>Member Directory</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Search  Connect  Email</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Referral System Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Referrals</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>Invite & Earn</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Rewards  Speaking Slots</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mobile App Preview -->
                        <div style="text-align: center;">
                            <h3 style="color: #e8eaed; margin-bottom: 1rem;"> Mobile App</h3>
                            <div style="background: linear-gradient(135deg, #0a0a0b 0%, #1a1a1b 100%); border-radius: 12px; padding: 1rem; border: 1px solid rgba(212, 175, 55, 0.2);">
                                <div style="height: 200px; display: flex; align-items: center; justify-content: center; color: #d4af37;">
                                    <div>
                                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                        <div>Progressive Web App</div>
                                        <div style="font-size: 0.8rem; opacity: 0.7;">Install  Offline  Notifications</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; text-align: center;">
                        <button onclick="sharePortalPreview()" style="background: #d4af37; color: #000; border: none; padding: 1rem 2rem; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 0.5rem;">
                             Share Preview
                        </button>
                        <button onclick="downloadPreviewInstructions()" style="background: rgba(255,255,255,0.1); color: #e8eaed; border: 1px solid rgba(255,255,255,0.2); padding: 1rem 2rem; border-radius: 8px; font-weight: 500; cursor: pointer; margin: 0.5rem;">
                             Screenshot Guide
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(previewModal);
        }

        // Share portal preview functionality
        function sharePortalPreview() {
            const shareText = ` Check out the Miami Business Council Member Portal!

Features include:
 AI-powered smart business matching
 Direct member-to-member messaging  
 Comprehensive member directory
 Referral system with rewards
 Mobile app (PWA) functionality
 Analytics and networking insights

Perfect for Miami business leaders looking to grow their network and find ideal clients!

#MiamiBusinessCouncil #Networking #BusinessGrowth #AI #Miami`;

            if (navigator.share) {
                navigator.share({
                    title: 'Miami Business Council Member Portal',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText + '\\n\\n' + window.location.href).then(() => {
                    alert('Preview description copied to clipboard!');
                });
            }
        }

        // Download instructions for taking screenshots
        function downloadPreviewInstructions() {
            const instructions = ` PORTAL SCREENSHOT GUIDE

To create professional preview images for the MBC Portal:

DESKTOP SCREENSHOTS (1280x720):
1. Dashboard View: Show main dashboard with cards and navigation
2. Smart Matches: Display the AI matching interface with member matches
3. Member Directory: Show the searchable member directory
4. Chat Interface: Display the messaging system in action

MOBILE SCREENSHOTS (750x1334):
1. Mobile Dashboard: Vertical layout on phone
2. Chat Mobile: Mobile messaging interface
3. Mobile Navigation: Show the slide-out menu
4. PWA Install: Show the install prompt

TIPS FOR GREAT SCREENSHOTS:
 Use full browser window at specified dimensions
 Hide personal/test data - use sample member names
 Show the portal in its best state (populated with data)
 Use consistent lighting and clear text
 Show interactive elements like hover states
 Include the gold accent colors prominently

TOOLS RECOMMENDED:
 Browser DevTools device simulator
 Screenshotting tools: Cleanshot X, Snagit, or built-in browser tools
 Image editing: Figma, Canva, or Photoshop for final touches

Once created, save as:
 /Images/portal-preview-desktop.png
 /Images/portal-preview-mobile.png  
 /Images/portal-smart-matches.png
 /Images/portal-member-directory.png
 /Images/portal-preview.png (main social sharing image)

This will enable beautiful previews when sharing the portal link on social media and in the mobile app store!`;

            // Create downloadable text file
            const blob = new Blob([instructions], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'MBC-Portal-Screenshot-Guide.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Hidden admin function - add to browser console for preview generation
        window.generatePortalScreenshots = function() {
            console.log('%c MBC Portal Screenshot Mode', 'color: #d4af37; font-size: 16px; font-weight: bold;');
            console.log('Use these browser dimensions for optimal screenshots:');
            console.log('Desktop: 1280x720 (16:9)');
            console.log('Mobile: 750x1334 (iPhone)');
            console.log('Take screenshots of each section for the preview gallery.');
            
            // Add visual guidelines
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(212, 175, 55, 0.1);
                border: 3px dashed #d4af37;
                pointer-events: none;
                z-index: 9999;
            `;
            
            const label = document.createElement('div');
            label.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #d4af37;
                color: #000;
                padding: 1rem;
                border-radius: 8px;
                font-weight: 600;
                z-index: 10000;
                pointer-events: auto;
                cursor: pointer;
            `;
            label.textContent = ' Screenshot Mode (Click to Exit)';
            label.onclick = () => {
                overlay.remove();
                label.remove();
            };
            
            document.body.appendChild(overlay);
            document.body.appendChild(label);
            
            setTimeout(() => {
                overlay.remove();
                label.remove();
            }, 10000);
        };

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setupPhotoUpload();
            initializeChatSystem();
            initializePrivacySettings();
            initializeReferralSystem();
            initializePWA();
        });
    </script>
    
    <!-- Supabase client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase client
        const SUPABASE_URL = 'https://vsnvtujkkkbjpuuwxvyd.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZzbnZ0dWpra2tianB1dXd4dnlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MzUyNDYsImV4cCI6MjA3MTIxMTI0Nn0.GwWKrl_6zlIBvIaJs8NngoheF24nNzAfBO5_j_d1ogA';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Enhanced member data loading from Supabase
        async function loadMembersFromDatabase() {
            try {
                console.log('Loading members from Supabase database...');
                
                const { data: members, error } = await supabase
                    .from('members')
                    .select(`
                        *,
                        business_opportunities (
                            opportunity_type,
                            category
                        )
                    `)
                    .eq('is_active', true);

                if (error) {
                    console.error('Supabase error:', error);
                    return getHardcodedMembers();
                }

                console.log(`Loaded ${members.length} members from database`);
                
                // Transform database format to portal format
                return members.map(member => {
                    const lookingFor = member.business_opportunities
                        ?.filter(opp => opp.opportunity_type === 'looking_for')
                        ?.map(opp => opp.category) || [];
                    
                    const canOffer = member.business_opportunities
                        ?.filter(opp => opp.opportunity_type === 'can_offer')
                        ?.map(opp => opp.category) || [];

                    return {
                        id: member.id,
                        name: `${member.first_name} ${member.last_name}`,
                        company: member.company_name,
                        industry: member.industry,
                        avatar: `${member.first_name.charAt(0)}${member.last_name.charAt(0)}`.toUpperCase(),
                        lookingFor,
                        canOffer,
                        linkedin: member.linkedin_url,
                        score: Math.floor(Math.random() * 30) + 70 // Random score 70-99
                    };
                });
                
            } catch (error) {
                console.error('Error loading members from database:', error);
                return getHardcodedMembers();
            }
        }

        // Enhanced business matching with real data
        async function generateMatchesFromDatabase() {
            try {
                const response = await fetch('/api/business-matching', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        member_id: 'current-user-id', // This would be the logged-in user
                        looking_for: Array.from(document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active')).map(tag => tag.textContent),
                        can_offer: Array.from(document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active')).map(tag => tag.textContent),
                        limit: 10
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    return result.data;
                } else {
                    console.error('Failed to fetch matches from database');
                    return generateMatches(); // Fallback to client-side matching
                }
            } catch (error) {
                console.error('Error fetching matches:', error);
                return generateMatches(); // Fallback to client-side matching
            }
        }

        // Enhanced member connection with database
        async function connectWithMemberDatabase(memberName, memberId) {
            try {
                const response = await fetch('/api/connections', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        requester_id: 'current-user-id', // This would be the logged-in user
                        recipient_id: memberId,
                        message: `Hi ${memberName}, I'd like to connect with you through Miami Business Council.`
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    alert(`Connection request sent to ${memberName}! They'll receive an email notification.`);
                } else {
                    const error = await response.json();
                    alert(`Failed to send connection: ${error.error}`);
                }
            } catch (error) {
                console.error('Error sending connection:', error);
                alert(`Error sending connection request. Please try again.`);
            }
        }

        // Enhanced profile saving with database
        async function saveProfileToDatabase() {
            try {
                const profileData = {
                    first_name: document.querySelector('input[value="John Smith"]').value.split(' ')[0],
                    last_name: document.querySelector('input[value="John Smith"]').value.split(' ')[1] || '',
                    company_name: document.querySelector('input[value="Smith Consulting LLC"]').value,
                    job_title: document.querySelector('input[value="Founder & CEO"]').value,
                    industry: document.querySelector('select').value,
                    linkedin_url: document.querySelector('input[type="url"]').value,
                    company_size: document.querySelector('input[name="company-size"]:checked').value,
                    looking_for: Array.from(document.querySelectorAll('.opportunity-section:first-child .opportunity-tag.active')).map(tag => tag.textContent),
                    can_offer: Array.from(document.querySelectorAll('.opportunity-section:nth-child(2) .opportunity-tag.active')).map(tag => tag.textContent)
                };

                const response = await fetch('/api/members?id=current-user-id', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(profileData)
                });

                if (response.ok) {
                    alert('Profile saved successfully to database!');
                    // Refresh matches with new preferences
                    findMatches();
                } else {
                    const error = await response.json();
                    alert(`Failed to save profile: ${error.error}`);
                    // Fallback to localStorage
                    saveProfile();
                }
            } catch (error) {
                console.error('Error saving profile:', error);
                // Fallback to localStorage
                saveProfile();
            }
        }

        // Fallback function for hardcoded members (when database not connected)
        function getHardcodedMembers() {
            return [
                {
                    name: 'April Sabral',
                    company: 'AskApril AI',
                    industry: 'Technology',
                    avatar: 'AS',
                    lookingFor: ['Business partnerships', 'Marketing expertise', 'Clients'],
                    canOffer: ['AI/Tech consulting', 'Platform development', 'Technical expertise'],
                    linkedin: 'https://linkedin.com/in/apriljsabral',
                    score: 92
                },
                {
                    name: 'Tommy Martinez', 
                    company: 'The Madyun Group',
                    industry: 'Real Estate',
                    avatar: 'TM',
                    lookingFor: ['Business development', 'Strategic partnerships', 'Investors'],
                    canOffer: ['Real estate expertise', 'Network connections', 'Mentoring'],
                    linkedin: null,
                    score: 78
                },
                {
                    name: 'Ilmoda Team',
                    company: 'Ilmoda',
                    industry: 'Fashion',
                    avatar: 'IM',
                    lookingFor: ['Investors', 'Marketing partnerships', 'Retail opportunities'],
                    canOffer: ['Fashion expertise', 'Design services', 'Brand partnerships'],
                    linkedin: null,
                    score: 71
                }
            ];
        }

        // Update existing functions to use database when available
        // Override generateMatches to try database first
        const originalGenerateMatches = generateMatches;
        generateMatches = async function() {
            try {
                const databaseMatches = await generateMatchesFromDatabase();
                if (databaseMatches && databaseMatches.length > 0) {
                    return databaseMatches;
                }
            } catch (error) {
                console.log('Using fallback matching algorithm');
            }
            return originalGenerateMatches();
        };

        // Override connectWithMember to try database first
        const originalConnectWithMember = connectWithMember;
        connectWithMember = async function(memberName, memberId = null) {
            if (memberId) {
                await connectWithMemberDatabase(memberName, memberId);
            } else {
                originalConnectWithMember(memberName);
            }
        };

        // Override saveProfile to try database first
        const originalSaveProfile = saveProfile;
        saveProfile = async function() {
            try {
                await saveProfileToDatabase();
            } catch (error) {
                console.log('Using fallback profile saving');
                originalSaveProfile();
            }
        };

        // Initialize database connection when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadMembersFromDatabase().then(members => {
                console.log(`Loaded ${members.length} members from database`);
                // Update member directory with real data
                updateMemberDirectory(members);
                // Update dashboard member counts
                updateMemberCounts(members.length);
            });
        });

        // Update member directory with database members
        function updateMemberDirectory(members) {
            const memberGrid = document.querySelector('.member-grid');
            if (!memberGrid || members.length === 0) return;

            const memberCardsHtml = members.map(member => `
                <div class="member-card">
                    <div class="member-header">
                        <div class="member-avatar">${member.avatar}</div>
                        <div class="member-info">
                            <h3>${member.name}</h3>
                            <p>${member.company}</p>
                            <p>${member.industry || 'Business'}</p>
                        </div>
                    </div>
                    <div class="member-details">
                        ${member.lookingFor.map(tag => `<span class="member-tag">${tag}</span>`).join('')}
                        ${member.canOffer.map(tag => `<span class="member-tag">${tag}</span>`).join('')}
                    </div>
                    ${member.linkedin 
                        ? `<a href="${member.linkedin}" class="linkedin-btn" target="_blank"> LinkedIn Profile</a>`
                        : `<a href="mailto:contact@miamibusinesscouncil.com?subject=Connect with ${member.name}" class="linkedin-btn"> Connect</a>`
                    }
                </div>
            `).join('');

            memberGrid.innerHTML = memberCardsHtml;
        }

        // Update member counts in dashboard stats
        function updateMemberCounts(memberCount) {
            // Update total member count in regular member dashboard
            const totalMemberCountElement = document.getElementById('totalMemberCount');
            if (totalMemberCountElement) {
                totalMemberCountElement.textContent = memberCount;
            }
            
            // Update total member count in admin dashboard
            const adminTotalMemberCountElement = document.getElementById('adminTotalMemberCount');
            if (adminTotalMemberCountElement) {
                adminTotalMemberCountElement.textContent = memberCount;
            }
        }
    </script>


    <style>
    .contact-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(18, 18, 18, 0.95);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding: 0.75rem 1rem;
        z-index: 999;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    }

    .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .footer-contact {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        text-align: center;
    }

    .contact-label {
        color: #d4d6da;
        font-size: 0.9rem;
        font-weight: 500;
    }

    .contact-support {
        background: linear-gradient(135deg, #d4af37 0%, #f4af37 100%);
        color: #000;
        text-decoration: none;
        padding: 0.5rem 1rem;
        border-radius: 25px;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        white-space: nowrap;
    }

    .contact-support:hover {
        background: linear-gradient(135deg, #f4af37 0%, #d4af37 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }

    .contact-note {
        color: #999;
        font-size: 0.8rem;
    }

    /* Adjust main content to account for footer */
    .portal-container {
        padding-bottom: 60px;
    }

    /* Mobile responsive */
    @media (max-width: 480px) {
        .footer-contact {
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .contact-label,
        .contact-note {
            font-size: 0.8rem;
        }
        
        .contact-support {
            font-size: 0.85rem;
            padding: 0.4rem 0.8rem;
        }
    }
    </style>

</body>
</html>